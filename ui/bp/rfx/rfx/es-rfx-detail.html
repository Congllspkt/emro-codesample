<sc-link rel="import" href="../shared/ep-apply.html"></sc-link>
<sc-link rel="import" href="../../shared/ep-job-list.html"></sc-link>
<sc-link rel="import" href="../shared/ep-item-detail-spec.html"></sc-link>
<sc-link rel="import" href="../shared/ep-item-perform.html"></sc-link>
<sc-link rel="import" href="../shared/ep-vendor-perform.html"></sc-link>
<sc-link rel="import" href="../shared/ep-sales-plan-list.html"></sc-link>
<sc-link rel="import" href="../sitebriefing/ep-fi-list.html"></sc-link>
<sc-link rel="import" href="../sitebriefing/ep-fi-detail.html"></sc-link>
<sc-link rel="import" href="ep-rfx-vd-rcmd-option.html"></sc-link>
<sc-link rel="import" href="cc-rfx-progress-state.html"></sc-link>
<sc-link rel="import" href="../bidnotice/ep-bidnotice-list.html"></sc-link>

<sc-link rel="import" href="ep-rfx-mail-work-history.html"></sc-link>

<sc-link rel="import" href="../../shared/ep-vendor-list.html"></sc-link>
<sc-link rel="import" href="../../../bp/common/bidtemplate/ep-bidtemplate-list.html"></sc-link>
<sc-link rel="import" href="../../../bp/common/bidtemplate/ep-bidtemplate-info.html"></sc-link>
<sc-link rel="import" href="../shared/ep-rfx-invite-vendor-reg.html"></sc-link>



<dom-module id="es-rfx-detail">
<!--
/**
 *
 *	@description : RFX 현황
 *  <pre>
 * </pre>
 * @author : Yeon-u Kim
 * @FileName :
 * @Since 2016. 5. 9.
 * @변경이력 : [2016. 5. 9.] Yeon-u Kim 최초작성
 */
-->
	<style>
		:host {
			@apply(--vbox-layout);
		}
	</style>

	<template>
		<!--<sc-panel title-text="Validation Summary">
			<div class="hbox">
				<div className="vbox" style="height: 70px;width: 70px;text-align: center;">
					<div class="flex">
						<div style="height: 50px;width: 50px;border-radius: 50%;background-color: #b40404;position: absolute;top: 15px;left: 10px;"></div>
					</div>
					<div>무슨무슨무슨 제목입니다.</div>
				</div>
				<div className="vbox" style="height: 100px;width: 100px;align-items: center;">
					<div style="height: 50px;width: 50px;border-radius: 50%;background-color: #b40404"></div>
					<div>으하하하하</div>
				</div>
				<div className="vbox" style="height: 100px;width: 100px;align-items: center;">
					<div style="height: 50px;width: 50px;border-radius: 50%;background-color: #b40404"></div>
					<div>으하하하하</div>
				</div>
			</div>
		</sc-panel>-->

		<!-- ajax 선언 부 -->
		<!-- 조회 -->
		<sc-ajax id="findRfx"
				 url="findRfxData.do"
				 body="{{searchParam}}"
				 on-response="completeFind">
		</sc-ajax>

		<sc-ajax id="findRfxDefaultDataByReqItemIds"
				 url="findRfxDefaultDataByReqItemIds.do">
		</sc-ajax>

		<sc-ajax id="findRfxDefaultDataByRfiId"
				 url="findRfxDefaultDataByRfiId.do">
		</sc-ajax>

		<sc-ajax id="findRfxDefaultDataByAiItemIds"
				 url="findRfxDefaultDataByAiItemIds.do">
		</sc-ajax>

		<!-- 저장 -->
		<sc-ajax id="saveRfx"
				 url="saveDraftRfx.do"
				 on-response="completeSaveRfx">
		</sc-ajax>

		<!-- 삭제 -->
		<sc-ajax
				id="deleteRfx"
				url="deleteRfx.do"
				body="{{rfxData}}"
				on-response="completeDeleteRfx">
		</sc-ajax>

		<!-- 즉시 견적 요청 -->
		<sc-ajax
				id="directRfxQta"
				url="directRfxBid.do"
				on-response="completeDirectRfxQta">
		</sc-ajax>

		<!-- RFP 비가격평가기준 설정여부, 원가구성항목 설정 확인 -->
		<sc-ajax id="checkBeforeRequestRfx"
				 url="checkBeforeRequestRfx.do">
		</sc-ajax>

		<!-- 취소 -->
		<sc-ajax id="cancelRfx"
				 url="cancelRfx.do"
				 body="{{rfxData}}"
				 on-response="completeCancelRfx">
		</sc-ajax>

		<!-- Rfx 복사 -->
		<sc-ajax id="copyRfx"
				 url="copyRfx.do"
				 body="{{rfxData}}"
				 on-response="completeCopyRfx">
		</sc-ajax>

		<!-- 추천 업체 대상 조회 -->
		<sc-ajax id="findListRcmdVd"
				 url="findListRfxRcmdTargVendor.do">
		</sc-ajax>

		<cc-code-constraint code-param="{{codes.setupParam}}" value="{{codes.setupInfo}}"></cc-code-constraint>

		<!-- 코드 조회 -->
		<sc-request-group init>
			<!-- 가격선정방식 -->
			<sc-ajax
					id="findCommonCodeAttrCdList"
					url="findListCommonCodeAttributeCode.do"
					body="{{codes.param}}"
					last-response="{{codes.slctnTypCcd}}">
			</sc-ajax>
			<sc-ajax
					url="findListCommonCodeAttributeCode.do"
					body="{{codes.pymtmethParam}}"
					last-response="{{codes.pymtmethAttrCcds}}">
			</sc-ajax>
			<sc-ajax
					url="findListCommonCodeAttributeCode.do"
					body="{{codes.dlvymethParam}}"
					last-response="{{codes.dlvymethAttrCcds}}">
			</sc-ajax>

			<sc-code-group>
				<!-- 경쟁 방식 -->
				<sc-code code="P211" value="{{codes.compTypCcd}}"></sc-code>
				<!-- UOM -->
				<sc-code code="C007" value="{{codes.uomCcd}}"></sc-code>
				<!-- 내외자 구분 -->
				<sc-code code="C024" value="{{codes.domovrsDivCcd}}"></sc-code>
				<!-- 품목 선정 유형(총액별/품목별) -->
				<sc-code code="P002" value="{{codes.itemSlctnTypCcd}}"></sc-code>
				<!-- 지급방법/설명 -->
				<sc-code code="P009" value="{{codes.pymtmethCcd}}"></sc-code>
				<!-- 납품방법/설명 -->
				<sc-code code="P010" value="{{codes.dlvymethCcd}}"></sc-code>
				<!-- RFx 유형 -->
				<sc-code code="P033" value="{{codes.rfxTypCcd}}"></sc-code>
				<!-- 구매 유형 -->
				<sc-code code="P045" value="{{codes.p2pPurcTypCcd}}"></sc-code>
				<!-- RFX 목적 -->
				<sc-code code="P049" value="{{codes.rfxPurpCcd}}"></sc-code>
				<!-- 컨소시엄 유형 -->
				<sc-code code="P100" value="{{codes.cstmTypCcd}}"></sc-code>
			</sc-code-group>
		</sc-request-group>

		<cc-auth-checker check-list="auth-a,auth-s,auth-r,auth-mwrfx"></cc-auth-checker>

		<cc-page-title-bar title-text="[[formula('title')]]" hidden="[[formula('isView')]]" i18n-disabled>
			<sc-button text="비가격평가 작성" on-click="onNonPriSet" hidden="[[!formula('isRfpConfig')]]" auth-s></sc-button>
			<sc-button text="CostStructure(RFX) 설정" on-click="onPriFactSet" hidden="[[!formula('isPriFactSet')]]" auth-s></sc-button>
			<sc-button text="비드템플릿 항목 설정" on-click="onTemplateRFQSet" hidden="[[!formula('isTemplateRFQSet')]]" auth-s></sc-button>
			<sc-button text="저장" on-click="onTempSave" hidden="[[!formula('editable')]]" auth-s></sc-button>
			<sc-button text="RFX 발신" on-click="onReqRfxQta" hidden="[[!formula('editable')]]" auth-a></sc-button>
			<sc-button text="결재 요청" on-click="onReqApprovalBtn" hidden="[[!formula('editable')]]" auth-a></sc-button>
			<sc-button text="RFX 복사" on-click="onCopyRfx" hidden="[[!formula('copyable')]]" auth-s></sc-button>
			<sc-button text="RFX 취소" on-click="onCancelRfx" hidden="[[!formula('cancelable')]]" auth-s></sc-button>
			<sc-button text="RFX 삭제" on-click="onDelete" hidden="[[!formula('deletable')]]" auth-s></sc-button>
			<sc-button text="RFX 결과" on-click="onShowResultDetail" hidden="[[!formula('showResultDetailBtn')]]" auth-r></sc-button>
			<sc-button text="닫기" on-click="onClose"></sc-button>
		</cc-page-title-bar>

		<cc-page-title-bar title-text="[[formula('title')]]" hidden="[[!formula('isView')]]" i18n-disabled>
			<sc-button text="닫기" on-click="onClose"></sc-button>
		</cc-page-title-bar>

		<cc-rfx-progress-state id="rfxProgressBar" rfx-data="[[rfxData]]"></cc-rfx-progress-state>

		<cc-link-document id="es_rfx_link_doc" param="{{rfxData}}" app-type="RFX"></cc-link-document>

		<div class="flex page">

			<cc-approval-summary app-id="{{rfxData.rfx_uuid}}" aprv-typcd="{{apvlTypCcd}}" hidden="[[!formula('requestedApproval')]]" auth-r></cc-approval-summary>

			<cc-form-panel id="searchPanel" title-text="일반 정보" validation-group="rfxInfo">
				<cc-fieldset>
					<sc-label text="운영조직"></sc-label>
					<cc-operorg-combobox-field id="operorgcombobox" oper-unit-cd="PO" value="{{rfxData.oorg_cd}}" selected-index="0" placeholder="필수" required="true" disabled="[[!formula('creatable')]]" on-change="onChangeOperOrgCd"></cc-operorg-combobox-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="구매 유형"></sc-label>
					<sc-combobox-field display-field="label" value-field="data" items="{{codes.p2pPurcTypCcd}}" value="{{rfxData.purc_typ_ccd}}" selected-index="0" placeholder="필수" required="true" readonly="[[!formula('creatable')]]"></sc-combobox-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="RFX 번호/진행차수"></sc-label>
					<div class="field-box" style="width:100%">
						<sc-text-field class="w-150" value="{{rfxData.rfx_no}}" readonly></sc-text-field>
						<span style="margin:0 5px">&#47;</span>
						<sc-text-field class="w-50 align-right" value="{{rfxData.rfx_rnd}}" readonly></sc-text-field>
						<span style="margin-left:5px">[[translate('진행차수')]]</span>
					</div>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="제목"></sc-label>
					<sc-text-field required="true" value="{{rfxData.rfx_tit}}" readonly="[[!formula('firstRoundEditable')]]" max-length="200"></sc-text-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="RFX 유형"></sc-label>
					<sc-combobox-field display-field="label" value-field="data" items="{{codes.rfxTypFilterCd}}" value="{{rfxData.rfx_typ_ccd}}" placeholder="필수" required="true" readonly="true"></sc-combobox-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="RFX 목적"></sc-label>
					<sc-combobox-field display-field="label" value-field="data" items="{{codes.rfxPurpFilterCcd}}" selected-index="0" value="{{rfxData.rfx_purp_ccd}}" placeholder="필수" required="true" readonly="[[!formula('creatable')]]"></sc-combobox-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="구매 담당자"></sc-label>
					<sc-text-field value="{{rfxData.purc_chr_nm}}" readonly></sc-text-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="구매 담당자 부서"></sc-label>
					<sc-text-field value="{{rfxData.purc_chr_dept_nm}}" readonly></sc-text-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="구매 담당자 전화"></sc-label>
					<sc-text-field value="{{rfxData.purc_chr_phone_no}}" mask-re="/[0-9\-]/" strip-chars-re="/[ㄱ-힣]/" max-length="18" readonly></sc-text-field>
				</cc-fieldset>
			</cc-form-panel>

			<cc-form-panel title-text="진행방법" collapsible="true" validation-group="rfxInfo">
				<cc-fieldset>
					<sc-label text="경쟁 유형"></sc-label>
					<sc-combobox-field display-field="label" value-field="data" items="{{codes.compTypCcd}}" value="{{rfxData.comp_typ_ccd}}" selected-index="0" placeholder="필수" required="true" readonly="[[!formula('firstRoundEditable')]]"></sc-combobox-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="선정 유형"></sc-label>
					<sc-combobox-field display-field="label" value-field="data" items="{{codes.prcStlTypFilterCd}}" value="{{rfxData.slctn_typ_ccd}}" selected-index="0" placeholder="필수" required="true" readonly="[[!formula('firstRoundEditable')]]"></sc-combobox-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="품목 선정 유형"></sc-label>
					<sc-combobox-field display-field="label" value-field="data" items="{{codes.itemSlctnTypCcd}}" value="{{rfxData.item_slctn_typ_ccd}}" selected-index="0" placeholder="필수" required="true" readonly="[[!formula('firstRoundRFQEditable')]]"></sc-combobox-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="CostStructure(RFX) 사용 여부"></sc-label>
					<sc-radio-group-field value="{{rfxData.coststr_use_yn}}" readonly="[[!formula('firstRoundEditable')]]">
						<sc-radio-field label="예" input-value="Y"></sc-radio-field>
						<sc-radio-field label="아니오" input-value="N"></sc-radio-field>
					</sc-radio-group-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="현장(제안)설명회 여부"></sc-label>
					<sc-radio-group-field value="{{rfxData.bfg_yn}}" readonly="[[!formula('firstRoundEditable')]]">
						<sc-radio-field label="예" input-value="Y"></sc-radio-field>
						<sc-radio-field label="아니오" input-value="N"></sc-radio-field>
					</sc-radio-group-field>
				</cc-fieldset>
				<cc-fieldset hidden="[[!formula('isCsSetup')]]">
					<sc-label text="컨소시엄 사용 여부"></sc-label>
					<div class="field-box" style="width:100%">
						<sc-radio-group-field id="radio_cs_yn" value="{{rfxData.cstm_use_yn}}" readonly="[[!formula('firstRoundEditable')]]">
							<sc-radio-field label="예" input-value="Y"></sc-radio-field>
							<sc-radio-field label="아니오" input-value="N"></sc-radio-field>
						</sc-radio-group-field>
						<sc-label style="margin:0 5px 0 20px" text="컨소시엄 유형" hidden="[[!formula('showCsTyp')]]"></sc-label>
						<sc-combobox-field class="w-150" display-field="label" value-field="data" items="{{codes.cstmTypCcd}}" value="{{rfxData.cstm_typ_ccd}}" selected-index="0" placeholder="필수" required="true" readonly="[[!formula('firstRoundEditable')]]" hidden="[[!formula('showCsTyp')]]"></sc-combobox-field>
					</div>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="제안발표회 여부"></sc-label>
					<sc-radio-group-field id="radio_rfp_ann_yn" value="{{rfxData.presn_yn}}" readonly="[[!formula('firstRoundRFPEditable')]]">
						<sc-radio-field label="예" input-value="Y"></sc-radio-field>
						<sc-radio-field label="아니오" input-value="N"></sc-radio-field>
					</sc-radio-group-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="부분 투찰 허용 여부"></sc-label>
					<sc-radio-group-field id="radio_part_bid_yn" value="{{rfxData.prtl_bid_perm_yn}}" readonly="[[!formula('partBidAble')]]">
						<sc-radio-field label="예" input-value="Y"></sc-radio-field>
						<sc-radio-field label="아니오" input-value="N"></sc-radio-field>
					</sc-radio-group-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="사전심사 사용 여부"></sc-label>
					<sc-radio-group-field id="radio_rfx_pre_insp_yn" value="{{rfxData.rfx_presn_use_yn}}" readonly="[[!formula('firstRoundEditable')]]">
						<sc-radio-field label="예" input-value="Y"></sc-radio-field>
						<sc-radio-field label="아니오" input-value="N"></sc-radio-field>
					</sc-radio-group-field>
				</cc-fieldset>
				<cc-fieldset hidden="[[!formula('showTemplateYn')]]">
					<sc-label text="템플릿 사용 여부"></sc-label>
					<sc-radio-group-field id="radio_bid_templ_set_yn" value="{{rfxData.rfx_tmpl_use_yn}}" readonly="[[!formula('firstRoundEditable')]]">
						<sc-radio-field label="예" input-value="Y"></sc-radio-field>
						<sc-radio-field label="아니오" input-value="N"></sc-radio-field>
					</sc-radio-group-field>
				</cc-fieldset>
				<cc-fieldset hidden="[[!formula('isNoticeSetup')]]">
					<sc-label text="RFX 사전공고 번호" hidden="[[!formula('isNoticeSetup')]]"></sc-label>
					<div class="field-box" style="width:100%">
						<sc-text-field class="w-100" hidden="[[!formula('isNoticeSetup')]]" readonly="true" value="{{rfxData.rfx_prentc_no}}"></sc-text-field>
						<div class="hspace-5"></div>
						<sc-trigger-field id="fiNoTrigger" trigger-cls="field-search" hide-trigger="[[!formula('isNoticeSetup')]]" on-trigger-click="onShowPopupSearchBidNotice"></sc-trigger-field>
					</div>
				</cc-fieldset>
				<cc-fieldset hidden="[[!formula('isRfxTypRFP')]]">
					<sc-label text="평가 비율"></sc-label>
					<div class="field-box" style="width:100%">
						<span style="margin-right:5px">[[translate('가격')]] :</span>
						<sc-number-field id="prcEvalRate" class="w-60" value="{{rfxData.cbe_ro}}" format-type="integer"
										 min-value="0" max-value="100" max-length="3" validator="prcEvalRateValidator"
										 readonly="[[!formula('firstRoundEditable')]]"></sc-number-field>
						<span style="margin-right:5px">&#37;&nbsp;&nbsp;[[translate('비가격')]] :</span>
						<sc-number-field class="w-60" value="{{rfxData.npe_ro}}" readonly></sc-number-field>
						<span style="margin-right:5px">&#37;&nbsp;&#40;[[translate('협력사 공개 여부')]] :</span>
						<sc-radio-group-field value="{{rfxData.npe_ro_vd_pub_yn}}" readonly="[[!formula('firstRoundEditable')]]">
							<sc-radio-field label="예" input-value="Y"></sc-radio-field>
							<sc-radio-field label="아니오" input-value="N"></sc-radio-field>
						</sc-radio-group-field>
						<span>&#41;</span>
					</div>
				</cc-fieldset>
				<cc-fieldset style="align-self: center;" hidden="[[!formula('isRfxTypRFP')]]">
					<sc-label text="종합평가 합격 점수"></sc-label>
					<div class="field-box" style="width:100%">
						<sc-number-field class="w-100" value="{{rfxData.compreval_pass_sc}}" required="true" max-value="100" min-value="0" readonly="[[!formula('editable')]]"></sc-number-field>
						<span style="margin-left:5px">[[translate('점 이상')]]</span>
					</div>
				</cc-fieldset>
				<cc-fieldset hidden="[[!formula('multiRoundRFP')]]">
					<sc-label text="비가격평가 재수행 여부"></sc-label>
					<sc-radio-group-field value="{{rfxData.npe_reexec_yn}}" readonly="[[!formula('multiRoundRFPEditable')]]" required="[[formula('multiRoundRFP')]]" disable-auto-select="true">
						<sc-radio-field label="예" input-value="Y"></sc-radio-field>
						<sc-radio-field label="아니오" input-value="N"></sc-radio-field>
					</sc-radio-group-field>
				</cc-fieldset>
				<cc-fieldset hidden="[[!formula('isShowLongTerm')]]">
					<sc-label text="장기적 생산량 효과 여부"></sc-label>
					<sc-radio-group-field value="{{rfxData.long_term_prod_eff_use_yn}}" readonly="[[!formula('editable')]]" disable-auto-select="true">
						<sc-radio-field label="예" input-value="Y"></sc-radio-field>
						<sc-radio-field label="아니오" input-value="N"></sc-radio-field>
					</sc-radio-group-field>
					<div class="hspace-5"></div>
					<sc-button text="생산 판매계획" on-click="onSalesPlan" hidden="[[!formula('isShowLongTermBtn')]]"></sc-button>
				</cc-fieldset>
			</cc-form-panel>

			<cc-form-panel label-width="200" title-text="현장(제안)설명회/제안발표회 정보" collapsible="true" hidden="[[!formula('showRfpAnnDescPanel')]]">
				<cc-fieldset hidden="[[!formula('showRfpDesc')]]">
					<sc-label text="현장설명회 입력 사용 여부"></sc-label>
					<div class="field-box" style="width:100%">
						<sc-label text="직접 입력" hidden="[[formula('isNoEditFiDirectChecked')]]"></sc-label>
						<sc-checkbox-field input-value="{{rfxData.sitebrfg_inp_use_yn}}" checked-value="Y" un-checked-value="N"
										   readonly="[[!formula('firstRoundEditable')]]" on-checkchange="changeDirectFiYn"
										   hidden="[[formula('isNoEditFiDirectChecked')]]">
						</sc-checkbox-field>
						<sc-text-field class="w-100" hidden="[[formula('isFiDirectChecked')]]" readonly="true" required="true" value="{{rfxData.sitebrfg_no}}"></sc-text-field>
						<div class="hspace-5" hidden="[[!formula('firstRoundEditable')]]"></div>
						<sc-trigger-field id="fiNoTrigger" trigger-cls="field-search" hidden="[[!formula('isEditFiDirectUnChecked')]]" on-trigger-click="onPopupFieldIntroList"></sc-trigger-field>
					</div>
				</cc-fieldset>
				<cc-fieldset hidden="[[!formula('showRfpDesc')]]">
					<sc-label text="현장(제안)설명회 일시"></sc-label>
					<div class="field-box" style="width:100%" validation-group="rfpDescDt">
						<sc-date-field id="rfpDescDt" value="{{rfxData.bfg_dttm}}"
									   readonly="[[!formula('isEditFiDirectChecked')]]"
									   required="true"
									   validator="rfpDescDtValidator">
						</sc-date-field>
						<span style="margin-right:5px"></span>
						<sc-number-field id="rfpDescDtHour" class="w-60" min-value="0" max-value="23" max-length="2" input-cover="true" format-type="disp_time"
										 value="{{rfxData.bfg_dttm_hour}}"
										 regex="/^([0-1]?[0-9]|2[0-3])$/"
										 readonly="[[!formula('isEditFiDirectChecked')]]"
										 validator="rfpDescDtValidator">
						</sc-number-field>
						<span style="margin:0 2px">:</span>
						<sc-number-field id="rfpDescDtMin" class="w-60" min-value="0" max-value="59" max-length="2" input-cover="true" format-type="disp_time"
										 value="{{rfxData.bfg_dttm_min}}"
										 regex="/^[0-5]?[0-9]$/"
										 readonly="[[!formula('isEditFiDirectChecked')]]"
										 validator="rfpDescDtValidator">
						</sc-number-field>
					</div>
				</cc-fieldset>
				<cc-fieldset hidden="[[!formula('isFieldIntro')]]">
					<sc-label text="현장설명회 제목"></sc-label>
					<div class="field-box">
						<sc-text-field value="{{rfxData.sitebrfg_tit}}" readonly="true"></sc-text-field>
						<div class="hspace-5"></div>
						<sc-button style="width:65px" text="상세 정보" on-click="onPopupFieldIntroInfo"></sc-button>
					</div>
				</cc-fieldset>
				<cc-fieldset hidden="[[!formula('showRfpDesc')]]">
					<sc-label text="현장(제안)설명회 장소"></sc-label>
					<sc-text-field id="rfpDescLocat" value="{{rfxData.bfg_plc}}" readonly="[[!formula('isEditFiDirectChecked')]]" max-length="200"></sc-text-field>
				</cc-fieldset>
				<cc-fieldset hidden="[[!formula('showRfpDesc')]]">
					<sc-label text="현장(제안)설명회 담당자"></sc-label>
					<cc-user-search id="rfPDescChr" value="{{rfxData.bfg_pic_nm}}" result-field="usr_id" result-value="{{rfxData.bfg_pic_id}}" readonly="[[!formula('isEditFiDirectChecked')]]" hide-trigger="[[!formula('isEditFiDirectChecked')]]"></cc-user-search>
				</cc-fieldset>
				<cc-fieldset hidden="[[!formula('showRfpAnn')]]">
					<sc-label text="제안발표회 기간"></sc-label>
					<sc-period-date-field id="rfpAnnPeriod" validator="rfpAnnPeriodValidator" from-value="{{rfxData.presn_st_dt}}" to-value="{{rfxData.presn_clsg_dt}}" default-from-value="0d" default-to-value="1M" init-date="[[!formula('isSaved')]]" readonly="[[!formula('firstRoundEditable')]]" string-date="true"></sc-period-date-field>
				</cc-fieldset>
				<cc-fieldset hidden="[[!formula('showRfpAnn')]]">
					<sc-label text="제안발표회 담당자"></sc-label>
					<cc-user-search value="{{rfxData.presn_pic_nm}}" result-field="usr_id" result-value="{{rfxData.presn_pic_id}}" disabled="[[!formula('firstRoundEditable')]]" hide-trigger="[[!formula('firstRoundEditable')]]"></cc-user-search>
				</cc-fieldset>
			</cc-form-panel>

			<cc-form-panel title-text="일정" collapsible="true">
				<cc-fieldset column-span="2" hidden="[[!formula('showRfxPreInspUseYn')]]">
					<sc-label text="사전심사 기간"></sc-label>
					<div class="field-box">
						<sc-label text="즉시 시작 사용 여부"></sc-label>
						<sc-checkbox-field input-value="{{rfxData.immed_rfx_presn_st_use_yn}}" checked-value="Y" un-checked-value="N"
										   readonly="[[!formula('editable')]]">
						</sc-checkbox-field>
						<span style="margin-right:5px"></span>
						<sc-date-field id="rpiStartDt"
									   value="{{rfxData.rfx_presn_st_dttm}}"
									   disabled="[[!formula('rpiStartDateEditable')]]"
									   readonly="[[!formula('editable')]]"
									   validator="rpiStartDtValidator"
									   validation-group="rpiStartDt">
						</sc-date-field>
						<span style="margin-right:5px"></span>
						<sc-number-field id="rpiStartDtHour" class="w-60" min-value="0" max-value="23" max-length="2" input-cover="true" format-type="disp_time"
										 value="{{rfxData.rfx_presn_st_dttm_hour}}"
										 regex="/^([0-1]?[0-9]|2[0-3])$/"
										 readonly="[[!formula('rpiStartDateEditable')]]"
										 validator="rfxStartDtValidator"
										 validation-group="rfxStartDt">
						</sc-number-field>
						<span style="margin-right: 2px;">:</span>
						<sc-number-field id="rpiStartDtMin" class="w-60" min-value="0" max-value="59" max-length="2" input-cover="true" format-type="disp_time"
										 value="{{rfxData.rfx_presn_st_dttm_min}}"
										 regex="/^[0-5]?[0-9]$/"
										 readonly="[[!formula('rpiStartDateEditable')]]"
										 validator="rpiStartDtValidator"
										 validation-group="rpiStartDt">
						</sc-number-field>

						<span style="margin-right: 2px;">~</span>

						<sc-date-field id="rpiEndDt" required="true"
									   value="{{rfxData.rfx_presn_clsg_dttm}}"
									   default-value="7d"
									   readonly="[[!formula('editable')]]"
									   validator="rpiEndDtValidator"
									   validation-group="rpiEndDt">
						</sc-date-field>
						<span style="margin-right:5px"></span>
						<sc-number-field id="rfxEndDtHour" class="w-60" min-value="0" max-value="23" max-length="2" input-cover="true" format-type="disp_time"
										 value="{{rfxData.rfx_presn_clsg_dttm_hour}}"
										 regex="/^([0-1]?[0-9]|2[0-3])$/"
										 readonly="[[!formula('editable')]]"
										 validator="rpiEndDtValidator"
										 validation-group="rpiEndDt">
						</sc-number-field>
						<span style="margin-right: 2px;">:</span>
						<sc-number-field id="rpiEndDtMin" class="w-60" min-value="0" max-value="59" max-length="2" input-cover="true" format-type="disp_time"
										 value="{{rfxData.rfx_presn_clsg_dttm_min}}"
										 regex="/^[0-5]?[0-9]$/"
										 readonly="[[!formula('editable')]]"
										 validator="rpiEndDtValidator"
										 validation-group="rpiEndDt">
						</sc-number-field>
					</div>
				</cc-fieldset>
				<cc-fieldset column-span="2">
					<sc-label text="기간"></sc-label>
					<div class="field-box">
						<sc-label text="즉시 시작 사용 여부"></sc-label>
						<sc-radio-group-field value="{{rfxData.immed_st_use_yn}}" readonly="[[!formula('editable')]]">
							<sc-radio-field label="예" input-value="Y"></sc-radio-field>
							<sc-radio-field label="아니오" input-value="N"></sc-radio-field>
						</sc-radio-group-field>
						<span style="margin-right:5px"></span>
						<sc-date-field id="rfxStartDt"
									   value="{{rfxData.rfx_st_dttm}}"
									   disabled="[[!formula('rfxStartDateEditable')]]"
									   readonly="[[!formula('editable')]]"
									   validator="rfxStartDtValidator"
									   validation-group="rfxStartDt">
						</sc-date-field>
						<span style="margin-right:5px"></span>
						<sc-number-field id="rfxStartDtHour" class="w-60" min-value="0" max-value="23" max-length="2" input-cover="true" format-type="disp_time"
										 value="{{rfxData.rfx_st_dttm_hour}}"
										 regex="/^([0-1]?[0-9]|2[0-3])$/"
										 readonly="[[!formula('rfxStartDateEditable')]]"
										 validator="rfxStartDtValidator"
										 validation-group="rfxStartDt">
						</sc-number-field>
						<span style="margin-right: 2px;">:</span>
						<sc-number-field id="rfxStartDtMin" class="w-60" min-value="0" max-value="59" max-length="2" input-cover="true" format-type="disp_time"
										 value="{{rfxData.rfx_st_dttm_min}}"
										 regex="/^[0-5]?[0-9]$/"
										 readonly="[[!formula('rfxStartDateEditable')]]"
										 validator="rfxStartDtValidator"
										 validation-group="rfxStartDt">
						</sc-number-field>

						<span style="margin-right: 2px;">~</span>

						<sc-date-field id="rfxCloseDt" required="true"
									   value="{{rfxData.rfx_clsg_dttm}}"
									   default-value="7d"
									   readonly="[[!formula('editable')]]"
									   validator="rfxCloseDtValidator"
									   validation-group="rfxCloseDt">
						</sc-date-field>
						<span style="margin-right:5px"></span>
						<sc-number-field id="rfxCloseDtHour" class="w-60" min-value="0" max-value="23" max-length="2" input-cover="true" format-type="disp_time"
										 value="{{rfxData.rfx_clsg_dttm_hour}}"
										 regex="/^([0-1]?[0-9]|2[0-3])$/"
										 readonly="[[!formula('editable')]]"
										 validator="rfxCloseDtValidator"
										 validation-group="rfxCloseDt">
						</sc-number-field>
						<span style="margin-right: 2px;">:</span>
						<sc-number-field id="rfxCloseDtMin" class="w-60" min-value="0" max-value="59" max-length="2" input-cover="true" format-type="disp_time"
										 value="{{rfxData.rfx_clsg_dttm_min}}"
										 regex="/^[0-5]?[0-9]$/"
										 readonly="[[!formula('editable')]]"
										 validator="rfxCloseDtValidator"
										 validation-group="rfxCloseDt">
						</sc-number-field>
					</div>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="개찰 일시"></sc-label>
					<div class="field-box" style="width:100%" validation-group="openDt">
						<sc-label text="즉시 개찰 사용 여부"></sc-label>
						<sc-radio-group-field value="{{rfxData.immed_open_use_yn}}" readonly="[[!formula('imdtOpenYnEditable')]]"
											  disabled="[[formula('showRfxPreInspUseYn')]]">
							<sc-radio-field label="예" input-value="Y"></sc-radio-field>
							<sc-radio-field label="아니오" input-value="N"></sc-radio-field>
						</sc-radio-group-field>
						<span style="margin-right:5px"></span>
						<sc-date-field id="openDt"
									   value="{{rfxData.open_dttm}}"
									   disabled="[[!formula('openDateEditable')]]"
									   readonly="[[!formula('editable')]]"
									   validator="openDtValidator">
						</sc-date-field>
						<span style="margin-right:5px"></span>
						<sc-number-field id="openDtHour" class="w-60" min-value="0" max-value="23" max-length="2" input-cover="true" format-type="disp_time"
										 value="{{rfxData.open_dttm_hour}}"
										 regex="/^([0-1]?[0-9]|2[0-3])$/"
										 readonly="[[!formula('openDateEditable')]]"
										 validator="openDtValidator">
						</sc-number-field>
						<span style="margin-right: 2px;">:</span>
						<sc-number-field id="openDtMin" class="w-60" min-value="0" max-value="59" max-length="2" input-cover="true" format-type="disp_time"
										 value="{{rfxData.open_dttm_min}}"
										 regex="/^[0-5]?[0-9]$/"
										 readonly="[[!formula('openDateEditable')]]"
										 validator="openDtValidator">
						</sc-number-field>
					</div>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="자동 연장 여부"></sc-label>
					<div class="field-box" style="width:100%" validation-group="autoExtTime">
						<sc-radio-group-field value="{{rfxData.auto_ext_use_yn}}" readonly="[[!formula('editable')]]">
							<sc-radio-field label="예" input-value="Y"></sc-radio-field>
							<sc-radio-field label="아니오" input-value="N"></sc-radio-field>
						</sc-radio-group-field>
						<span style="padding-right:55px"></span>
						<span style="padding-right:10px">[[translate('연장 시간')]]</span>
						<sc-number-field id="autoExtTime" class="w-60" min-value="1" max-value="23" max-length="2"
										 value="{{rfxData.auto_ext_tm}}" input-cover="true" format-type="disp_time"
										 regex="/^(2[0-3]|1[0-9]|[1-9])$/"
										 readonly="[[!formula('autoExtTimeEditable')]]"
										 validator="autoExtTimeValidator">
						</sc-number-field>
					</div>
				</cc-fieldset>
			</cc-form-panel>

			<cc-form-panel title-text="계약 조건" collapsible="true" validation-group="rfxInfo">
				<cc-fieldset>
					<sc-label text="내외자 구분"></sc-label>
					<div class="field-box">
						<sc-combobox-field display-field="label" value-field="data" items="{{codes.domovrsDivCcd}}" value="{{rfxData.domovrs_div_ccd}}" selected-index="0" placeholder="필수" required="[[formula('firstRoundEditable')]]" readonly="[[!formula('firstRoundEditable')]]"></sc-combobox-field>
						<div class="hspace-10"></div>
						<sc-checkbox-field label="지급/납품방법 변경 가능 여부" input-value="{{rfxData.pymtmeth_dlvymeth_chg_poss_yn}}" checked-value="Y" un-checked-value="N" default-input-value="N" readonly="[[!formula('firstRoundEditable')]]"></sc-checkbox-field>
					</div>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="지체상금 비율"></sc-label>
					<div class="field-box" style="width:100%">
						<sc-number-field class="w-100 align-right" min-value="0" max-value="1000" value="{{rfxData.dfrm_ro}}" input-cover="true" format-type="decimal" readonly="[[!formula('firstRoundEditable')]]"></sc-number-field>
						<span style="margin-left:5px">/ 1000</span>
					</div>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="통화"></sc-label>
					<cc-cur-search value="{{rfxData.cur_ccd}}" required="[[formula('firstRoundEditable')]]" readonly="true" on-change="onChangeCur" hide-trigger="[[!formula('firstRoundEditable')]]" result-hidden="true"></cc-cur-search>
				</cc-fieldset>
				<cc-fieldset column-span="2" hidden="[[!formula('isShowDom')]]">
					<sc-label text="내자 지급방법/설명"></sc-label>
					<div class="field-box" style="width:100%">
						<sc-combobox-field class="w-350" display-field="label" value-field="data" items="{{codes.domPymtmethCcds}}" value="{{rfxData.pymtmeth_dom_ccd}}" placeholder="선택" readonly="[[!formula('firstRoundEditable')]]" required="[[formula('firstRoundEditable')]]"></sc-combobox-field>
						<span style="margin-right:5px"></span>
						<sc-text-field value="{{rfxData.pymtmeth_dom_expln}}" readonly="[[!formula('firstRoundEditable')]]" max-length="100"></sc-text-field>
					</div>
				</cc-fieldset>
				<cc-fieldset column-span="2" hidden="[[!formula('isShowDom')]]">
					<sc-label text="내자 납품방법/설명"></sc-label>
					<div class="field-box" style="width:100%">
						<sc-combobox-field class="w-350" display-field="label" value-field="data" items="{{codes.domDlvymethCcds}}" value="{{rfxData.dlvymeth_dom_ccd}}" placeholder="선택" readonly="[[!formula('firstRoundEditable')]]" required="[[formula('firstRoundEditable')]]"></sc-combobox-field>
						<span style="margin-right:5px"></span>
						<sc-text-field value="{{rfxData.dlvymeth_dom_expln}}" readonly="[[!formula('firstRoundEditable')]]" max-length="100"></sc-text-field>
					</div>
				</cc-fieldset>
				<cc-fieldset column-span="2" hidden="[[!formula('isShowOvs')]]">
					<sc-label text="외자 지급방법/설명"></sc-label>
					<div class="field-box" style="width:100%">
						<sc-combobox-field class="w-350" display-field="label" value-field="data" items="{{codes.ovsPymtmethCcds}}" value="{{rfxData.pymtmeth_ovs_ccd}}" placeholder="선택" readonly="[[!formula('firstRoundEditable')]]" required="[[formula('firstRoundEditable')]]"></sc-combobox-field>
						<span style="margin-right:5px"></span>
						<sc-text-field value="{{rfxData.pymtmeth_ovs_expln}}" readonly="[[!formula('firstRoundEditable')]]" max-length="100"></sc-text-field>
					</div>
				</cc-fieldset>
				<cc-fieldset column-span="2" hidden="[[!formula('isShowOvs')]]">
					<sc-label text="외자 납품방법/설명"></sc-label>
					<div class="field-box" style="width:100%">
						<sc-combobox-field class="w-350" display-field="label" value-field="data" items="{{codes.ovsDlvymethCcds}}" value="{{rfxData.dlvymeth_ovs_ccd}}" placeholder="선택" readonly="[[!formula('firstRoundEditable')]]" required="[[formula('firstRoundEditable')]]"></sc-combobox-field>
						<span style="margin-right:5px"></span>
						<sc-text-field value="{{rfxData.dlvymeth_ovs_expln}}" readonly="[[!formula('firstRoundEditable')]]" max-length="100"></sc-text-field>
					</div>
				</cc-fieldset>


				<cc-fieldset>
					<sc-label text="계약 기간"></sc-label>
					<sc-period-date-field class="w-250" name="cntr_dt" from-value="{{rfxData.cntr_st_dt}}" to-value="{{rfxData.cntr_exp_dt}}" id="cntrPeriod"
										  string-date="true"
										  validator="cntrPeriodValidator"
										  readonly="[[!formula('editable')]]">
					</sc-period-date-field>
				</cc-fieldset>
			</cc-form-panel>

			<cc-form-panel form-cls="label-column" title-text="첨부파일" collapsible="true">
				<cc-fieldset>
					<sc-label text="내부용"></sc-label>
					<sc-upload id="upload_in" class="h-200" value="{{rfxData.buyer_athg_uuid}}" editable="[[formula('editable')]]"></sc-upload>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="협력사용"></sc-label>
					<sc-upload id="upload_out" class="h-200" value="{{rfxData.vd_athg_uuid}}" editable="[[formula('editable')]]"></sc-upload>
				</cc-fieldset>
			</cc-form-panel>

			<cc-form-panel title-text="비고" collapsible="true">
				<cc-fieldset>
					<sc-label text="구매사 비고"></sc-label>
					<sc-textarea-field value="{{rfxData.rfx_buyer_rmk}}" max-length="1000" readonly="[[!formula('editable')]]"></sc-textarea-field>
				</cc-fieldset>
				<cc-fieldset>
					<sc-label text="협력사 비고"></sc-label>
					<sc-textarea-field value="{{rfxData.rfx_vd_rmk}}" max-length="1000" readonly="[[!formula('editable')]]"></sc-textarea-field>
				</cc-fieldset>
			</cc-form-panel>

			<sc-grid id="itemGridPanel" class="h-400" collapsible="true" aggregate=true use-dummy="false"
					 editable="[[formula('editable')]]"
					 use-state="[[formula('editable')]]"
					 use-selection="[[formula('firstRoundEditable')]]"
					 calc-footer-include-invisible="true"
					 on-item-click="onItemClick"
					 on-item-edit-end="onItemEditEnd">
				<cc-grid-toolbar title-text="[[formula('gridTitle')]]">
					<sc-button text="무코드 품목 추가" on-click="onAddNoCdItem" hidden="[[!formula('noCdItemAddable')]]" auth-s></sc-button>
					<sc-button text="품목 추가" on-click="onShowItemPopup" hidden="[[!formula('itemAddable')]]" auth-s></sc-button>
					<sc-button text="일괄 적용" on-click="onAllApplyBtn" hidden="[[!formula('firstRoundEditable')]]" auth-s></sc-button>
					<sc-button text="삭제" on-click="onDeleteRfxItem" hidden="[[!formula('itemAddable')]]" auth-s></sc-button>
				</cc-grid-toolbar>

				<sc-grid-columns>
					<sc-data-column		data-field="rfx_lno"	header-text="항번"					width="90"	data-type="number"	text-align="center"	editable="false"></sc-data-column>
					<sc-combobox-column	data-field="purc_typ_ccd"		header-text="구매 유형"				width="100"	text-align="center"	editable="false"
										display-field="label"		value-field="data"					items="{{codes.p2pPurcTypCcd}}"></sc-combobox-column>
					<sc-data-column		data-field="disp_item_cd"	header-text="품목 코드"				width="100"	text-align="center"	editable="false"></sc-data-column>
					<sc-data-column		data-field="sg_cd"	header-text="소싱그룹 코드"				width="100"	text-align="center"	editable="false"></sc-data-column>
					<sc-data-column		data-field="sg_nm"	header-text="소싱그룹 명"					width="100"	text-align="center"	editable="false"></sc-data-column>
					<sc-group-column	hide-child-headers="true"	header-text="품목 명"				width="280">
						<sc-data-column		data-field="disp_item_nm"										width="250"	text-align="left"	item-editable-function="onItemEditableFn"		max-length="500"	required="true"></sc-data-column>
						<sc-image-column	data-field="img_item_cd"	image-change-function="onImageChangeFn"	width="30"	text-align="center" editable="false"></sc-image-column>
					</sc-group-column>

					<sc-data-column		data-field="item_spec"			header-text="품목 규격"					width="250"	text-align="left"	item-editable-function="onItemEditableFn"		max-length="1000"
										item-style-function="onItemStyleFn"								validator-function="gridValidatorFn"></sc-data-column>
					<sc-image-column	data-field="img_item_spec_dtl"	header-text="품목 규격 상세"				width="60"	text-align="center"	visible="[[formula('hasNoCdItem')]]"
										image-change-function="onImageChangeFn"></sc-image-column>
					<sc-combobox-column	data-field="uom_ccd"		header-text="UOM"					width="60"	text-align="center"	item-editable-function="onItemEditableFn"		required="true"
										display-field="data"		value-field="data"					items="{{codes.uomCcd}}"></sc-combobox-column>
					<sc-data-column		data-field="rfx_qty"		header-text="수량"				width="80"	text-align="right"	item-editable-function="onItemEditableFn"		required="true"
										max-length="8"				editor-regex-function="onRegexFn" 	validate-on-cell-paste="true"	validator-function="gridValidatorFn"
										data-type="number"			format-type="qty"					></sc-data-column>
					<sc-data-column		data-field="rfx_req_uprc"		header-text="요청 단가"				width="140"	text-align="right"	item-editable-function="onItemEditableFn"
										max-length="13"				editor-regex-function="onRegexFn"	validate-on-cell-paste="true"	validator-function="gridValidatorFn"
										data-type="number"			format-type="price"					aggregate-title="합계"></sc-data-column>
					<sc-data-column		data-field="rfx_req_amt"		header-text="요청 금액"				width="140"	text-align="right"	editable="false"
										format-type="amt"			aggregate-function="onAmtAggregateFn"			aggregate-format="amt"
										sort-compare-function="onSortCompareFn"></sc-data-column>
					<sc-data-column		data-field="rfx_trg_uprc"		header-text="목표 단가"				width="120"	text-align="right"	item-editable-function="onItemEditableFn"
										max-length="13"				editor-regex-function="onRegexFn"	validate-on-cell-paste="true"	validator-function="gridValidatorFn"
										data-type="number"			format-type="price"					></sc-data-column>
					<sc-data-column		data-field="rfx_lmt_uprc"		header-text="제한 단가"				width="100"	text-align="right"	item-editable-function="onItemEditableFn"		visible="[[formula('showLMTColumn')]]"	required="true"
										max-length="13"				editor-regex-function="onRegexFn"	validate-on-cell-paste="true"	validator-function="gridValidatorFn"
										data-type="number"			format-type="price"					></sc-data-column>
					<sc-date-column		data-field="const_st_dt"			header-text="공사 시작 일자"			width="120"	text-align="center"	item-editable-function="onItemEditableFn"		visible="[[formula('showCTColumn')]]"	required="true"
										validator-function="gridValidatorFn"></sc-date-column>
					<sc-date-column		data-field="const_exp_dt"			header-text="공사 종료 일자"			width="120"	text-align="center"	item-editable-function="onItemEditableFn"		visible="[[formula('showCTColumn')]]"	required="true"
										validator-function="gridValidatorFn"></sc-date-column>
					<sc-date-column		data-field="req_dlvy_dt"		header-text="[[formula('reqDtText')]]"	width="150"	text-align="center"	item-editable-function="onItemEditableFn"		visible="[[formula('showMTColumn')]]"	required="true"
										validator-function="gridValidatorFn"></sc-date-column>
					<sc-group-column	hide-child-headers="true"	header-text="플랜트"			width="180"	text-align="center"	editable="false">
						<sc-data-column		data-field="plt_cd"				width="70"	text-align="center"	editable="false"></sc-data-column>
						<sc-data-column		data-field="plt_nm"				width="70"	text-align="center"	editable="false"></sc-data-column>
						<sc-image-column	image-cls="search" data-field="img_plant_select"		width="30"	text-align="center"
											editable="false"  visible="[[formula('noCdItemPlantAddable')]]" image-change-function="onImagePlantSelectShowFunction"></sc-image-column>
					</sc-group-column>
					<sc-data-column		data-field="dlvy_plc"		header-text="[[formula('rdLocatTitle')]]"		width="150"	text-align="left"	item-editable-function="onItemEditableFn"	visible="[[!formula('isRfxPurpUC')]]"	max-length="1000"	required="true"></sc-data-column>
					<sc-group-column	hide-child-headers="true"	header-text="구매 그룹"				width="180"	text-align="center"	editable="false">
						<sc-data-column	data-field="purc_grp_cd"										width="50"	text-align="center"	editable="false"	required="true"></sc-data-column>
						<sc-data-column		data-field="purc_grp_nm"									width="100"	text-align="center"	item-editable-function="onItemEditableFn"		required="true"></sc-data-column>
						<sc-image-column	data-field="img_purc_grp"	image-cls="search"				width="30"	text-align="center" editable="false"	visible="[[formula('firstRoundEditable')]]"></sc-image-column>
					</sc-group-column>
					<sc-data-column		data-field="pr_no"			header-text="구매요청 번호"			width="120"	text-align="center"	editable="false"	visible="[[formula('showPrColumn')]]"	style-name="link"></sc-data-column>
					<sc-data-column		data-field="pr_lno"			header-text="구매요청 항번"			width="120"	data-type="number" text-align="center"	editable="false"	visible="[[formula('showPrColumn')]]"></sc-data-column>
					<sc-data-column		data-field="upcr_no"		header-text="단가계약요청 번호"			width="120"	text-align="center"	editable="false"	visible="[[formula('showUpcrColumn')]]"	style-name="link"></sc-data-column>
					<sc-data-column		data-field="upcr_lno"		header-text="단가계약요청 항번"			width="120"	data-type="number" text-align="center"	editable="false"	visible="[[formula('showUpcrColumn')]]"></sc-data-column>
					<sc-data-column		data-field="sr_no"			header-text="소싱요청 번호"			width="120"	text-align="center"	editable="false"	visible="[[formula('showSrColumn')]]"	style-name="link"></sc-data-column>
					<sc-data-column		data-field="sr_lno"			header-text="소싱요청 항번"			width="120"	data-type="number" text-align="center"	editable="false"	visible="[[formula('showSrColumn')]]"></sc-data-column>
				</sc-grid-columns>
				<sc-grid-fields>
					<sc-grid-field data-field="rfx_item_uuid" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="rfx_uuid" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="rfx_rnd" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="oorg_cd" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="pr_uuid" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="pr_item_uuid" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="sr_uuid" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="sr_item_uuid" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="item_oorg_cd" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="upcr_uuid" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="upcr_item_uuid" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="cur_ccd" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="auto_po_yn" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="item_cd" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="item_nm" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="item_nm_en" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="item_cd_crn_typ_ccd" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="item_spec_dtl" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="rfx_req_rcpt_uuid"></sc-grid-field>
				</sc-grid-fields>
			</sc-grid>

			<sc-grid id="vdGridPanel" class="h-400" collapsible="true" use-dummy="false"
					 hidden="[[formula('hiddenVdGridPanel')]]"
					 editable="[[formula('editable')]]"
					 use-state="[[formula('editable')]]"
					 use-selection="[[formula('editable')]]"
					 on-item-click="onVdItemClick">
				<cc-grid-toolbar title-text="협력사 정보">
					<sc-button text="이메일 견적" on-click="onShowVendorMailWorkHistory" hidden="[[!formula('vdMailWorkable')]]" auth-mwrfx></sc-button>
					<sc-button text="협력사 검색" on-click="onShowPopupVendor" hidden="[[!formula('vdAddable')]]" auth-s></sc-button>
					<sc-button text="자동 추천" on-click="onShowPopupRcmdOption" hidden="[[!formula('vdRcmdable')]]" auth-s></sc-button>
					<sc-button text="협력사 초청(Quick RFX)" on-click="onShowPopupQuickRfx" hidden="[[!formula('vdAddable')]]" auth-s></sc-button>
					<sc-button text="삭제" on-click="onDeleteRfxVendor" hidden="[[!formula('vdDeletable')]]" auth-s></sc-button>
					<sc-button text="제외" on-click="onExcVendor" hidden="[[!formula('vdExcable')]]" auth-s></sc-button>
					<sc-button text="제외 취소" on-click="onCancelExcVendor" hidden="[[!formula('vdExcable')]]" auth-s></sc-button>
				</cc-grid-toolbar>
				<sc-grid-columns>
					<sc-group-column	hide-child-headers="true"		header-text="제외 여부"				width="90"	text-align="center"	visible="[[formula('showVdExcYnColumn')]]">
						<sc-data-column		data-field="multrnd_subj_xcept_yn"												width="60"	text-align="center"	editable="false"></sc-data-column>
						<sc-image-column	data-field="img_multrnd_xcept_rsn"										width="30"	text-align="center" editable="false"
											image-change-function="onVdExcImageChangeFn"></sc-image-column>
					</sc-group-column>
					<sc-data-column		data-field="sbmt_yn"			header-text="이전 차수 제출 여부"	width="120"	text-align="center"	visible="[[formula('showSbmtYnColumn')]]"	converter="onConvertSbmtYn"></sc-data-column>
					<sc-data-column		data-field="disp_vd_cd"			header-text="협력사 코드"			width="100"	text-align="center"	editable="false"></sc-data-column>
					<sc-group-column	hide-child-headers="true"		header-text="협력사 명"				width="230">
						<sc-data-column		data-field="vd_nm"												width="200"	text-align="left"	editable="false"></sc-data-column>
						<sc-image-column	data-field="img_vd_cd"		image-cls="link"					width="30"	text-align="center" editable="false"></sc-image-column>
					</sc-group-column>
					<sc-data-column		data-field="vd_pic_nm"			header-text="협력사 담당자 명"			width="120"	text-align="center"	editable="false"></sc-data-column>
					<sc-data-column		data-field="vd_pic_tel"	header-text="협력사 담당자 전화"	width="150"	text-align="left"	editable="true"	max-length="18"
										editor-maskre="/[0-9\-+]/"		hangul-restrict="true"></sc-data-column>
					<sc-data-column		data-field="vd_pic_eml"		header-text="협력사 담당자 이메일"		width="150"	text-align="left"	editable="true"	max-length="100"
										validator-function="vdGridValidatorFn"></sc-data-column>
					<sc-data-column		data-field="auto_rcmd_vd_yn"			header-text="추천 여부"				width="90"	text-align="center"	editable="false"></sc-data-column>
					<sc-data-column		data-field="rcmd_cnt"			header-text="추천 수"				width="60"	text-align="right"	editable="false" data-type="number" item-style-function="onVdItemStyleFn" converter="onConverterRcmdCnt"></sc-data-column>
				</sc-grid-columns>
				<sc-grid-fields>
					<sc-grid-field data-field="rfx_vd_uuid" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="rfx_uuid" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="erp_vd_cd" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="vd_cd" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="rfx_no" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="rfx_rnd" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="vd_pic_uuid" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="multrnd_subj_xcept_yn" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="multrnd_xcept_rsn" data-type="text"></sc-grid-field>
					<sc-grid-field data-field="rcmdList" data-type="object"></sc-grid-field>
				</sc-grid-fields>
			</sc-grid>
		</div>

		<!-- 제외 사유 dialog -->
		<sc-dialog id="dialog_multrnd_xcept_rsn" title-text="제외 사유" title-align="left" style="width:400px;height:250px" modal="true" draggable="true">
			<cc-page-title-bar>
				<sc-button text="입력" on-click="onExcCause" hidden="[[!formula('editable')]]" auth-s></sc-button>
			</cc-page-title-bar>
			<table class="tb-form">
				<tr>
					<td>
						<sc-textarea-field class="h-100" id="dialog_multrnd_xcept_rsn_text" value="" max-length="1000" readonly="[[!formula('editable')]]"></sc-textarea-field>
					</td>
				</tr>
			</table>
		</sc-dialog>
	</template>

	<script>
		Polymer({
			is: 'es-rfx-detail',
			properties: {
				searchParam: {
					type: Object,
					value: function() {
						return {
							rfx_uuid: ""
						}
					}
				},
				//결재 유형 코드
				apvlTypCcd: {
					type: String,
					value: function() {
						return "RFX";
					}
				},
				rfxData: {
					type: Object,
					value: function() {
						var currentUser = SCSessionManager.currentUser;
						return {
							is_new: false,
							saveType: '',
							rfx_uuid: "",
							rfx_no: "",
							rfx_rnd: 1,
							cur_ccd: "KRW",
							rfx_sts_ccd: "CRNG",
							rfx_apvl_sts_ccd: "CRNG",
							bfg_yn: "N",	//현장설명회 여부
							presn_yn: "N",	//제안발표 여부
							prtl_bid_perm_yn: "N",	//부분입찰가능 여부
							cstm_use_yn: "N",	//컨소시엄 여부
							coststr_use_yn: "N",	//원가구성항목설정 여부
							rfx_tmpl_use_yn: "N",	//Template 입찰 여부
							npe_ro_vd_pub_yn: "N",	//협력사공개 여부
							long_term_prod_eff_use_yn: "N",	//장기적 생산량 효과 여부
							presn_st_dt: '',
							presn_clsg_dt: '',
							cbe_typ_ccd: 'MIN_AMT_CRTRA_RO',	//가격평가유형 default : MR(최소금액기준비율)
							//noti_yn           : "N",	//공고 여부
							immed_open_use_yn: "Y",	//즉시개찰 여부
							immed_st_use_yn: "Y",	//즉시시작 여부
							auto_ext_use_yn: "N",	//자동시간연장 여부
							has_pr_item_yn: "N",
							has_upcr_item_yn: "N",
							has_no_cd_item: "N",
							rfx_clsg_dttm_hour: 18,
							rfx_clsg_dttm_min: 0,
							immed_rfx_presn_st_use_yn: "Y",
							rfx_presn_use_yn: "N",
							rfx_presn_clsg_dttm_hour: 18,
							rfx_presn_clsg_dttm_min: 0,
							purc_pic_id: currentUser.usr_id,
							purc_chr_nm: currentUser.disp_usr_nm,
							purc_chr_dept_nm: currentUser.disp_dept_nm,
							purc_chr_phone_no: currentUser.phone_no
						};
					}
				},
				selectedVdItemIndexes: {
					type: Array,
					value: function() {
						return [];
					}
				},
				codes: {
					type: Object,
					value: function() {
						return {
							uomCcd: [],
							compTypCcd: [],
							dlvymethCcd: [],
							pymtmethCcd: [],
							slctnTypCcd: [],
							prcStlTypFilterCd: [],
							p2pPurcTypCcd: [],
							rfxPurpCcd: [],
							rfxPurpFilterCcd: [],
							rfxTypCcd: [],
							rfxTypFilterCd: [],
							domovrsDivCcd: [],
							itemSlctnTypCcd: [],
							param: {
								cstr_cnd_cd: "RFX_TYP",
								co_cd: SCSessionManager.currentUser.co_cd,
								ccd: "P007",
								purc_grp_typ_ccd: "PURC"
							},
							cstmTypCcd: [],
							setupParam: {
								ccd: "C000",
								dtl_cd: "USE_YN"
							},
							setupInfo: {},
							domPymtmethCcds: [],
							ovsPymtmethCcds: [],
							domDlvymethCcds: [],
							ovsDlvymethCcds: [],
							pymtmethParam: {
								ccd: "P009",
								cstr_cnd_cd: "DOMOVRS_DIV"
							},
							dlvymethParam: {
								ccd: "P010",
								cstr_cnd_cd: "DOMOVRS_DIV"
							},
							pymtmethAttrCcds: [],
							dlvymethAttrCcds: [],
						};
					},
					reset: false
				},
				dupLnos: {
					type: Array,
					value: function() {
						return []
					}
				},
				// Url Copy
				copyValue: {
					type: Object,
					value: function() {
						return {};
					}
				},
				isView: {
					type: Object,
					value: function() {
						return false;
					}
				}
			},
			formulas: {
				isRfxTypRFQ: function() {
					return (this.rfxData.rfx_typ_ccd === "RFQ");
				},
				isRfxTypRFP: function() {
					return (this.rfxData.rfx_typ_ccd === "RFP");
				},
				isRfpConfig: function() {
					return this.formula('isRfxTypRFP') && !this.get("isViewConfig");
				},
				isPriFactSet: function() {
					return (this.rfxData.coststr_use_yn === "Y");
				},
				isBidTempleSet: function() {
					return (this.rfxData.rfx_tmpl_use_yn === "Y");
				},
				isSaved: function() {
					return UT.isNotEmpty(this.rfxData.rfx_uuid);
				},
				creatable: function() {
					return (UT.isEmpty(this.rfxData.rfx_uuid) && this.rfxData.is_new === true);
				},
				copyable: function() {
					return this.formula('isSaved') && !this.get("isViewConfig") && !this.formula('isPsrYn');
				},
				editable: function() {
					return (this.rfxData.rfx_sts_ccd === "CRNG");
				},
				firstRoundEditable: function() {
					return ((this.rfxData.rfx_rnd == 1) && this.formula('editable'));
				},
				firstRoundRFQEditable: function() {
					return (this.formula('isRfxTypRFQ') && this.formula('firstRoundEditable'));
				},
				firstRoundRFPEditable: function() {
					return (this.formula('isRfxTypRFP') && this.formula('firstRoundEditable'));
				},
				isMultiRound: function() {
					return (this.rfxData.rfx_rnd !== 1);
				},
				multiRoundEditable: function() {
					return (this.formula("isMultiRound") && this.formula('editable'));
				},
				multiRoundRFP: function() {
					return (this.formula('isRfxTypRFP') && this.formula('isMultiRound'));
				},
				multiRoundRFPEditable: function() {
					return (this.formula('multiRoundRFP') && this.formula('editable'));
				},
				partBidAble: function() {
					return (this.formula('firstRoundEditable') && this.rfxData.item_slctn_typ_ccd === "BYITEM");
				},
				isTemplateRFQSet: function() {
					return (this.rfxData.rfx_tmpl_use_yn === "Y" && this.rfxData.coststr_use_yn === "N");
				},
				hasPrItem: function() {
					return (this.rfxData.has_pr_item_yn === "Y");
				},
				hasUpcrItem: function() {
					return (this.rfxData.has_upcr_item_yn === "Y");
				},
				deletable: function() {
					return (this.formula('isSaved') && ["CRNG", "APVL_RET", "APVL_CNCL"].indexOf(this.rfxData.rfx_apvl_sts_ccd) > -1);
				},
				requestedApproval: function() {
					return (this.formula('isSaved') && ["APVL_PRGSG", "APVD", "APVL_RET"].indexOf(this.rfxData.rfx_apvl_sts_ccd) > -1);
				},
				cancelable: function() {
					//공고중 or 진행중 상태 시 취소 가능
					return (["NTC_PRGSG", "PRGSG"].indexOf(this.rfxData.rfx_sts_ccd) > -1);
				},
				itemAddable: function() {
					return (this.formula('firstRoundEditable') && !this.formula('hasPrItem') && !this.formula('hasUpcrItem'));
				},
				hiddenVdGridPanel: function() {
					return (this.rfxData.comp_typ_ccd === "OBID");
				},
				vdMailWorkable: function() {
					// RFx 견적 진행중이고, 원가구성항목설정이 아닐때만 이메일견적 가능함
					return this.rfxData.rfx_sts_ccd === "PRGSG" && !(this.formula('isPriFactSet') || (this.formula('isBidTempleSet')));
				},
				vdAddable: function() {
					return this.formula("editable");
				},
				vdRcmdable: function() {
					return this.formula("editable");
				},
				vdDeletable: function() {
					return this.formula("editable");
				},
				vdExcable: function() {
					return this.formula('multiRoundEditable');
				},
				//rfx사전심사시작일시
				rpiStartDateEditable: function() {
					return (this.rfxData.immed_rfx_presn_st_use_yn === "N" && this.formula('editable'));
				},
				rfxStartDateEditable: function() {
					return (this.rfxData.immed_st_use_yn === "N" && this.formula('editable'));
				},
				/*
				공고게시하는 경우 공고일자 edit 가능
				notiDateEditable : function() {
					return (this.rfxData.noti_yn === "Y" && this.formula('editable'));
				},
				*/
				autoExtTimeEditable: function() {
					return (this.rfxData.auto_ext_use_yn === "Y" && this.formula('editable'));
				},
				openDateEditable: function() {
					return (this.rfxData.immed_open_use_yn === "N" && this.formula('editable'));
				},
				isRfxPurpUC: function() {
					return (this.rfxData.rfx_purp_ccd === "UPRCCNTR_SGNG");
				},
				showMTColumn: function() {
					return (this.rfxData.purc_typ_ccd === "QTY" && !this.formula('isRfxPurpUC'));
				},
				showCTColumn: function() {
					return (this.rfxData.purc_typ_ccd === "CONSTSVC" && !this.formula('isRfxPurpUC'));
				},
				showPrColumn: function() {
					return this.formula("hasPrItem");
				},
				showUpcrColumn: function() {
					return this.formula("hasUpcrItem");
				},
				showSrColumn: function() {
					return (this.rfxData.rfx_purp_ccd === "PSR" && !UT.isEmpty(this.rfxData.rfx_uuid));
				},
				showLMTColumn: function() {
					return (this.rfxData.slctn_typ_ccd === "LTD_LOWSTPRC");
				},
				showSbmtYnColumn: function() {
					return this.formula("isMultiRound");
				},
				showVdExcYnColumn: function() {
					return this.formula("isMultiRound");
				},
				showResultDetailBtn: function() {
					return (["CLSG", "ED", "SLCTN_APVL_PRGSG"].indexOf(this.rfxData.rfx_sts_ccd) > -1) && !this.get("isViewConfig");
				},
				showRfpDesc: function() {
					return this.rfxData.bfg_yn === "Y";
				},
				showRfpAnn: function() {
					return this.rfxData.presn_yn === "Y";
				},
				showRfpAnnDescPanel: function() {
					return (this.formula('showRfpDesc') || this.formula('showRfpAnn'));
				},
				title: function() {
					var me = this;
					if(UT.isEmpty(me.rfxData.rfx_no)) {
						return me.translate('RFX 작성');
					}
					return me.rfxData.rfx_typ_ccd + " : " + me.rfxData.rfx_no;
				},
				rdLocatTitle: function() {
					var me = this;
					return (me.rfxData.purc_typ_ccd === "QTY") ? me.translate("납품 장소") : me.translate("납품 장소");
				},
				gridTitle: function() {
					var me = this;
					return (me.rfxData.purc_typ_ccd === "QTY") ? me.translate("품목 정보") : me.translate("공사/용역 정보");
				},
				noCdItemAddable: function() {
					return this.formula("itemAddable") && !this.formula("isRfxPurpUC");
				},
				hasNoCdItem: function() {
					var me = this;
					return me.get("rfxData.has_no_cd_item") === "Y";
				},
				noCdItemPlantAddable: function() {
					var me = this;
					return me.formula("editable") && me.formula("hasNoCdItem");
				},
				// 현장 설명회
				isFieldIntro: function() {
					return !UT.isEmpty(this.rfxData.sitebrfg_uuid);
				},

				// 현장 설명회 직접입력
				isFiDirectChecked: function() {
					var me = this;
					return me.get("rfxData.sitebrfg_inp_use_yn") === "Y";
				},
				// 현장 설명회 직접입력 & NoEditable
				isNoEditFiDirectChecked: function() {
					var me = this;
					return (!me.formula('firstRoundEditable') && !me.formula('isFiDirectChecked'));
				},
				// 현장 설명회 직접입력 & Editable
				isEditFiDirectChecked: function() {
					var me = this;
					return (me.formula('firstRoundEditable') && me.formula('isFiDirectChecked'));
				},
				// 현장 설명회 직접입력 & Editable
				isEditFiDirectUnChecked: function() {
					var me = this;
					return (me.formula('firstRoundEditable') && me.get("rfxData.sitebrfg_inp_use_yn") === "N");
				},
				// 컨소시엄 셋업 여부
				isCsSetup: function() {
					var me = this;
					return me.get("codes.setupInfo.rfx_cstm") === "Y" && !me.formula("isRfxPurpUC");
				},
				// 컨소시엄 유형 보이기
				showCsTyp: function() {
					return this.get("rfxData.cstm_use_yn") === "Y";
				},
				// 입찰공고 셋업 여부
				isNoticeSetup: function() {
					var me = this;
					return (me.get("codes.setupInfo.rfx_prentc") === "Y" && me.get("rfxData.comp_typ_ccd") === "CBID");
				},
				// BidTemplate 셋업 여부
				showTemplateYn: function() {
					return this.get("codes.setupInfo.rfx_bidtmpl") === "Y";
				},
				showRfxPreInspUseYn: function() {
					return this.get("rfxData.rfx_presn_use_yn") === "Y";
				},
				imdtOpenYnEditable: function() {
					var me = this;
					return (!me.formula('showRfxPreInspUseYn') && me.formula('editable'));
				},
				isView: function() {
					var me = this;
					return (me.get('isView'));
				},
				isShowDom: function(){
					var me = this,
						divData = me.get("rfxData.domovrs_div_ccd");

					return UT.isEmpty(divData) ? false : divData.indexOf("DOM") > -1;
				},
				isShowOvs: function(){
					var me = this,
						divData = me.get("rfxData.domovrs_div_ccd");

					return UT.isEmpty(divData) ? false : divData.indexOf("OVS") > -1;
				},
				isPsrYn: function(){
					return this.get("rfxData.rfx_purp_ccd") === "PSR";
				},
				isShowLongTerm: function(){
					return (this.get("rfxData.rfx_purp_ccd") === "PSR") && this.formula('isExistPcm');
				},
				isShowLongTermBtn: function(){
					return (this.get("rfxData.long_term_prod_eff_use_yn") === "Y") && this.formula('isExistPcm');
				},
				isExistPcm: function(){
					return SCModuleManager.exist("PCM");
				},
				reqDtText: function() {
					var me = this;
					var rfxData = me.get("rfxData");

					return rfxData.rfx_purp_ccd === "PSR" ? "SR 요청 일자" : "요청 납품 일자";
				}
			},
			observers: [
				'changePurcTyp(rfxData.purc_typ_ccd)',
				'changeRfxTyp(rfxData.rfx_typ_ccd)',
				'changeVdStlTyp(rfxData.item_slctn_typ_ccd)',
				'changePrcStlTyp(rfxData.slctn_typ_ccd)',
				'changeRfxPurp(rfxData.rfx_purp_ccd)',
				'changeCptTyp(rfxData.comp_typ_ccd)',
				'changePrcEvalRate(rfxData.cbe_ro)',
				'changeRfpAnnYn(rfxData.presn_yn)',
				'changeRfpDescYn(rfxData.bfg_yn)',
				'changeImdtStartYn(rfxData.immed_st_use_yn)',
				//'changeNotiYn(rfxData.noti_yn)',
				'changeAutoExtYn(rfxData.auto_ext_use_yn)',
				'changeImdtOpenYn(rfxData.immed_open_use_yn)',
				'changePriFactSetYn(rfxData.coststr_use_yn)',
				'changeTemplateSetYn(rfxData.rfx_tmpl_use_yn)',
				'changeCsYn(rfxData.cstm_use_yn)',
				'changeRfxPreInspUseYn(rfxData.rfx_presn_use_yn)',
				'changeImdtRpiStartYn(rfxData.immed_rfx_presn_st_use_yn)',
				'changeDomOvrsDivCcd(rfxData.domovrs_div_ccd)',
				'changeLongTermProd(rfxData.long_term_prod_eff_use_yn)'
			],

			/**************************************************
			 * 화면 바인딩 처리
			 **************************************************/
			// 계약 기간 required
			requiredCntrDt: function() {
				var me = this;
				var p2pPurcTypCcd   = me.get("rfxData.purc_typ_ccd"),
					rfxPurp = me.get("rfxData.rfx_purp_ccd");

				var elements = this.querySelectorAll('[name=cntr_dt]');
				for(var i in elements) {
					// 구매유형이 공사용역이거나 RFx 목적이 단가계약인 경우 계약 기간 필수
					elements[i].required = (p2pPurcTypCcd === "CONSTSVC" || rfxPurp === "UPRCCNTR_SGNG" || rfxPurp === "PSR");
				}
			},

			// 구매 유형 변경시
			changePurcTyp: function(purcTyp) {
				var me = this;

				me.applyFormula('showMTColumn', 'showCTColumn', 'gridTitle', 'rdLocatTitle');
				me.requiredCntrDt();

				if(me.formula('creatable')) {
					var provider = me.$.itemGridPanel.getDataProvider();
					var obj = {};
					if(purcTyp !== "QTY") {
						obj.req_dlvy_dt = null;
						obj.dlvy_plc = null;
					}
					if(purcTyp !== "CONSTSVC") {
						obj.const_st_dt = null;
						obj.const_exp_dt = null;
						obj.dlvy_plc = null;
					}
					var i = 0;
					provider.setItemAtBatch(true, function(index, data) {
						return {"purc_typ_ccd" : purcTyp, obj};
					});
				}
			},
			//RFx 유형 변경시
			changeRfxTyp: function(rfxTyp) {
				var me = this;

				me.applyFormula('isRfxTypRFP');
				me.applyFormula('isRfxTypRFQ');
				me.applyFormula('firstRoundRFPEditable');
				me.applyFormula('firstRoundRFQEditable');

				if(!me.formula('isSaved')) {
					if(rfxTyp === "RFP") {
						me.set("rfxData.item_slctn_typ_ccd", "BYTOT");	//RFP는 항상 총액
						me.set("rfxData.cbe_ro", 60);
						me.set("rfxData.npe_ro", 40);
					}
				}
			},
			//품목 선정 유형 변경
			changeVdStlTyp: function(vdStlTyp) {
				var me = this;

				me.applyFormula('partBidAble');

				if(me.formula('firstRoundEditable')) {
					//총액이면 부분입찰 불가능
					if(vdStlTyp === "BYTOT") {
						me.set("rfxData.prtl_bid_perm_yn", "N");
					}
				}
			},
			//선정 유형 변경시
			changePrcStlTyp: function(prcStlTyp) {
				var me = this;

				me.applyFormula('showLMTColumn');

				if(me.get('loadCompleted')) {
					if(prcStlTyp !== "LTD_LOWSTPRC") {
						var provider = me.$.itemGridPanel.getDataProvider();
						provider.setItemAtBatch(true, function(index, data) { //index: rowIndex, data: row데이터
							return {rfx_lmt_uprc: null};
						});

					}
				}
			},
			//Rfx 목적
			changeRfxPurp: function(rfxPurp) {
				var me = this;

				var afterChanged = function() {
					me.applyFormula('isRfxPurpUC', 'isCsSetup', 'isNoticeSetup', 'showMTColumn', 'showCTColumn', 'hasNoCdItem', 'noCdItemAddable', 'isShowLongTerm');
					me.requiredCntrDt();
				};

				if(rfxPurp === "UPRCCNTR_SGNG" && me.formula('creatable') && me.get('loadCompleted')) {
					var provider = me.$.itemGridPanel.getDataProvider();

					if(provider.filterItem({item_cd_crn_typ_ccd: "CDLS"}) != null) {
						// "RFx목적을 단가계약으로 변경 시 무코드 품목은 목록에서 제외됩니다.<br/>계속 진행하시겠습니까?"
						UT.confirm(me.translate("STD.RFX1096", null, me.translate("계약 유형")),
								function() {	// yes 버튼
									// 무코드 품목 삭제
									provider.removeItemAtBatch(true, function(index, data) {
										if(data.item_cd_crn_typ_ccd === "CDLS") {
											return true;
										}
									});
									me.set("rfxData.has_no_cd_item", "N");
									me.set("rfxData.cstm_use_yn", "N");
									afterChanged();

									var itemLno = 0;
									provider.setItemAtBatch(true, function(index, data) {
										itemLno += 10;
										return {
											"rfx_lno": itemLno,
											"const_st_dt": null,
											"const_exp_dt": null,
											"req_dlvy_dt": null,
											"dlvy_plc": null
										};
									});
								},
								function() {	// no 버튼
									me.set("rfxData.rfx_purp_ccd", "SPTPURC");	// 일반구매로 다시 되돌려줌
									afterChanged();
								}
								, true);
					} else {
						afterChanged();
					}
				} else {
					afterChanged();
				}
			},
			//경쟁 유형 변경시
			changeCptTyp: function(compTypCcd) {
				var me = this;

				if(me.get('loadCompleted')) {
					var provider = me.$.vdGridPanel.getDataProvider();

					if(compTypCcd === "PRICNTR") {
						if(provider.getItemSize() > 1) {
							UT.alert("STD.RFX1009");	//"경쟁 방식이 수의계약일 경우 하나의 협력사만 지정이 가능합니다. 협력사수를 확인하여주세요."
							me.set("rfxData.comp_typ_ccd", "CBID");
							return;
						}
						me.set("rfxData.rfx_prentc_no", "");
					} else if(compTypCcd === "OBID") {
						//경쟁 방식이 공개일 경우 협력사 그리드 data clear
						provider.removeAll();
						me.set("rfxData.rfx_prentc_no", "");
						/*
						 * removeAll(collectionRemoveItems=default:true)
						 * -> removeItems에 담아두고 getRemoveItems()를 사용하여 DB에서 삭제할 데이터를 반환
						 */
					}
				}
				me.applyFormula('hiddenVdGridPanel');
				me.applyFormula('isNoticeSetup');
			},
			// 현장설명회 여부 변경시
			changeRfpDescYn: function(rfpDescYn) {
				var me = this;

				me.applyFormula('showRfpAnnDescPanel');
				me.applyFormula('showRfpDesc');

				if(rfpDescYn === "N") {
					me.set("rfxData.sitebrfg_uuid", null);
					me.set("rfxData.sitebrfg_no", null);
					me.set("rfxData.sitebrfg_tit", null);
					me.set("rfxData.bfg_dttm", null);
					me.set("rfxData.bfg_dttm_hour", null);
					me.set("rfxData.bfg_dttm_min", null);
					me.set("rfxData.bfg_plc", null);
					me.set("rfxData.bfg_pic_id", null);
					me.set("rfxData.bfg_pic_nm", null);

					me.$.rfpDescDt.clearInvalid();
					me.$.rfpDescDtHour.clearInvalid();
					me.$.rfpDescDtMin.clearInvalid();

				}

				me.applyFormula('isFieldIntro');
			},
			//제안발표 여부 변경시
			changeRfpAnnYn: function(rfpAnnYn) {
				var me = this;

				me.applyFormula('showRfpAnnDescPanel');
				me.applyFormula('showRfpAnn');

				if(rfpAnnYn === "N") {
					me.set("rfxData.presn_st_dt", null);
					me.set("rfxData.presn_clsg_dt", null);
					me.set("rfxData.presn_pic_nm", null);
					me.set("rfxData.presn_pic_id", null);

					me.$.rfpAnnPeriod.clearInvalid();

					me.$.rfpAnnPeriod.required = false;
				} else {
					me.$.rfpAnnPeriod.required = true;
				}
			},
			//가격 평가 비율 변경시 비가격 평가 비율 변경
			changePrcEvalRate: function(prcEvalRate) {
				var me = this;

				if(UT.isNumber(prcEvalRate)) {
					me.set("rfxData.npe_ro", 100 - parseInt(prcEvalRate, 10));
				} else {
					me.set("rfxData.cbe_ro", 0);
					me.set("rfxData.npe_ro", 100);
				}
			},
			changeImdtRpiStartYn: function(imdtRpiStartYn) {
				var me = this;

				me.applyFormula('rpiStartDateEditable');

				if(imdtRpiStartYn === "Y") {
					me.set("rfxData.rfx_presn_st_dttm", null);
					me.set("rfxData.rfx_presn_st_dttm_hour", null);
					me.set("rfxData.rfx_presn_st_dttm_min", null);

					me.$.rpiStartDt.clearInvalid();
					me.$.rpiStartDtHour.clearInvalid();
					me.$.rpiStartDtMin.clearInvalid();
				}
				me.$.rpiStartDt.required = (imdtRpiStartYn === "N");
			},
			//즉시시작 여부
			changeImdtStartYn: function(imdtStartYn) {
				var me = this;

				me.applyFormula('rfxStartDateEditable');

				if(imdtStartYn === "Y") {
					me.set("rfxData.rfx_st_dttm", null);
					me.set("rfxData.rfx_st_dttm_hour", null);
					me.set("rfxData.rfx_st_dttm_min", null);

					me.$.rfxStartDt.clearInvalid();
					me.$.rfxStartDtHour.clearInvalid();
					me.$.rfxStartDtMin.clearInvalid();
				}
				me.$.rfxStartDt.required = (imdtStartYn === "N");
			},
			/*
			//공고 여부
			changeNotiYn : function(notiYn) {
				var me = this;

				me.applyFormula('notiDateEditable');

				if(notiYn === "N") {
					me.set("rfxData.noti_dt", null);

					me.$.notiDt.clearInvalid();
				}

				me.$.notiDt.required = (notiYn === "Y");
			},
			*/
			//자동시간연장여부 변경시 호출
			changeAutoExtYn: function(autoExtYn) {
				var me = this;

				me.applyFormula('autoExtTimeEditable');

				if(autoExtYn === "Y") {
					me.$.autoExtTime.required = true;
				} else {
					me.set("rfxData.auto_ext_tm", null);
					me.$.autoExtTime.required = false;
					me.$.autoExtTime.clearInvalid();
				}
				me.$.autoExtTime.required = (autoExtYn === "Y");
			},
			//즉시개찰 여부 변경시 호출
			changeImdtOpenYn: function(imdtOpenYn) {
				var me = this;

				me.applyFormula('openDateEditable');

				if(imdtOpenYn === "Y") {
					me.set("rfxData.open_dttm", null);
					me.set("rfxData.open_dttm_hour", null);
					me.set("rfxData.open_dttm_min", null);

					me.$.openDt.clearInvalid();
					me.$.openDtHour.clearInvalid();
					me.$.openDtMin.clearInvalid();
				}
				me.$.openDt.required = (imdtOpenYn === "N");
			},
			//원가구성 사용 여부 변경 시 호출
			changePriFactSetYn: function(priFactSetYn) {
				this.applyFormula('isPriFactSet');

				if(priFactSetYn === "Y") {
					this.set("rfxData.rfx_tmpl_use_yn", "N");
					this.applyFormula('isTemplateRFQSet');
				}
			},
			//Template입찰 변경 시 호출
			changeTemplateSetYn: function(bidTemplateSetYn) {

				if(bidTemplateSetYn === "Y") {
					this.set("rfxData.coststr_use_yn", "N");
				}
				this.applyFormula('isTemplateRFQSet');
			},
			// 컨소시엄 사용 여부 변경 시 호출
			changeCsYn: function(csYn) {
				this.applyFormula('showCsTyp');
			},
			//rfx사전심사사용여부
			changeRfxPreInspUseYn(rfxPreInspUseYn) {
				if(rfxPreInspUseYn === "Y") {
					this.set("rfxData.immed_open_use_yn", "N");
				}
				this.applyFormula('showRfxPreInspUseYn');
				this.applyFormula('imdtOpenYnEditable');
			},
			//운영조직 변경 시 호출
			onChangeOperOrgCd: function(e) {
				var me = this;

				if(!e.isTrusted) {
					var operOrgCds =   me.$.operorgcombobox.get("codes.operOrgCd");
					var operOrgCd = me.get("rfxData.oorg_cd");
					if(me.formula('creatable') && UT.isNotEmpty(operOrgCd)){
						var operOrgCdMap = UT.arrayFilterChange(operOrgCds, {key:  'oorg_cd' , value: operOrgCd });
						me.set("rfxData.cur_ccd",operOrgCdMap[0]['cur_ccd']);
					}
					if(me.formula('creatable') && me.get('loadCompleted')) {
						var itemProvider = me.$.itemGridPanel.getDataProvider();
						var vdProvider = me.$.vdGridPanel.getDataProvider();

						if(UT.isNotEmpty(itemProvider) && UT.isNotEmpty(vdProvider) && (itemProvider.getItemSize() + vdProvider.getItemSize() > 0)) {
							UT.alert("STD.RFX1033");	//"운영조직 변경시 품목 및 협력사 목록 정보가 초기화 됩니다."

							itemProvider.removeAll();
							vdProvider.removeAll();
							/*
							 * removeAll(collectionRemoveItems=default:true)
							 * -> removeItems에 담아두고 getRemoveItems()를 사용하여 DB에서 삭제할 데이터를 반환
							 */
						}
					}
				}
			},
			// 통화 변경시
			onChangeCur: function(e) {
				var me = this

				if(me.get('loadCompleted') && me.formula("firstRoundEditable")) {
					var cur_ccd = me.get("rfxData.cur_ccd");

					var provider = me.$.itemGridPanel.getDataProvider();
					if(provider) {
						provider.setItemAtBatch(true, function(nodeIndex, data) {
							var price     = data["rfx_req_uprc"] || 0,											// RFX 요청 단가
								qty       = data["rfx_qty"] || 0,											// 수량
								precPrice = CCPrecManager.format("price", price, cur_ccd),						// RFX 요청 단가 소수점처리
								amt       = (new BigNumber(precPrice)).mul(new BigNumber(qty)).toFixed(),	// 금액 = RFX 요청 단가 소수점처리 * 수량
								precAmt   = CCPrecManager.format("amt", amt, cur_ccd);							// 금액 소수점처리

							return {
								"rfx_req_uprc": precPrice,
								"rfx_req_amt": precAmt,
								"cur_ccd": cur_ccd
							}
						});
					}
				}
			},

			// 현장 설명회 직접 입력 변경 시
			changeDirectFiYn: function() {
				var me = this;
				if(me.get('loadCompleted') && me.formula('firstRoundEditable') && me.rfxData.bfg_yn === 'Y') {
					me.set("rfxData.sitebrfg_uuid", null);
					me.set("rfxData.sitebrfg_no", null);
					me.set("rfxData.sitebrfg_tit", null);
					me.set("rfxData.bfg_dttm", null);
					me.set("rfxData.bfg_dttm_hour", null);
					me.set("rfxData.bfg_dttm_min", null);
					me.set("rfxData.bfg_plc", null);
					me.set("rfxData.bfg_pic_id", null);
					me.set("rfxData.bfg_pic_nm", null);
					me.applyFormula('isFieldIntro');
				}
				me.applyFormula('isFiDirectChecked');
				me.applyFormula('isNoEditFiDirectChecked');
				me.applyFormula('isEditFiDirectChecked');
				me.applyFormula('isEditFiDirectUnChecked');
			},

			/**************************************************
			 * 초기화 설정
			 **************************************************/
			// 1. 화면 로딩시 최초 호출
			initialized: function() {
				var me = this;

				me.$.prcEvalRate.regex = CCPrecManager.regex('integer');

				// RFX 유형 필터: RA유형은 제거
				var codes = me.codes.rfxTypCcd;
				var filtered = codes.filter(function(code) {
					return code.data !== "RAUC";
				});
				me.set("codes.rfxTypFilterCd", filtered);

				me.initCommonCodeSettingForPymtDlvyMeth();
			},
			// 2. 화면 load
			load: function(param) {
				var me = this;

				//rfx-config
				if(!UT.isEmpty(param.is_view_config)) {
					me.set("isViewConfig", true);
				} else {
					me.set("isViewConfig", false);
				}

				me.set("loadCompleted", false);
				if(UT.isNotEmpty(param.rfx_uuid)) {
					// key 존재 시 조회
					me.set("searchParam", param);
					// Url Copy Param Set
					me.set("copyValue", {
						app_id: param.rfx_uuid
					});
					if(UT.isNotEmpty(param.isView)) {
						me.set("isView", param.isView || false);
					}
					me.findRfxDetail();
				} else if(UT.isNotEmpty(param.rfi_uuid)) {
					me.findDefaultDataByRfiItems(param);
				} else if(UT.isNotEmpty(param.rfx_req_rcpt_uuids) && UT.isArray(param.rfx_req_rcpt_uuids)) {
					me.findDefaultDataByReqItems(param);
				} else if(UT.isNotEmpty(param.item_cds) && (param.ai_recommendation || true)) {
					me.findDefaultDataByAiItems(param);
				} else if(UT.isNotEmpty(param.is_config) && param.is_config) {
					var rfxInfo = UT.copy(param.rfxInfo);
					me.filterComboCodes(rfxInfo);

					if(!UT.isEmpty(rfxInfo.oorg_cd)) {
						me.set("rfxData.oorg_cd", rfxInfo.oorg_cd);
					}
					me.set("rfxData.rfx_typ_ccd", rfxInfo.rfx_typ_ccd);
					me.set("rfxData.rfx_tit", rfxInfo.rfx_tit);
					me.set("rfxData.purc_typ_ccd", rfxInfo.purc_typ_ccd);
					me.set("rfxData.rfx_purp_ccd", rfxInfo.rfx_purp_ccd);
					me.set("rfxData.comp_typ_ccd", rfxInfo.comp_typ_ccd);
					me.set("rfxData.slctn_typ_ccd", rfxInfo.slctn_typ_ccd);
					me.set("rfxData.item_slctn_typ_ccd", rfxInfo.item_slctn_typ_ccd);
					me.set("rfxData.coststr_use_yn", rfxInfo.coststr_use_yn);
					me.set("rfxData.bfg_yn", rfxInfo.bfg_yn);
					me.set("rfxData.cstm_use_yn", rfxInfo.cstm_use_yn);
					me.set("rfxData.presn_yn", rfxInfo.presn_yn);
					me.set("rfxData.rfx_presn_use_yn", rfxInfo.rfx_presn_use_yn);
					me.set("rfxData.prtl_bid_perm_yn", rfxInfo.prtl_bid_perm_yn);
					me.set("rfxData.domovrs_div_ccd", rfxInfo.domovrs_div_ccd);
					me.set("rfxData.cur_ccd", rfxInfo.cur_ccd);
					if(!UT.isEmpty(rfxInfo.domovrs_div_ccd)) {
						switch(rfxInfo.domovrs_div_ccd) {
							case "DOM":
								me.set("rfxData.pymtmeth_dom_ccd", rfxInfo.pymtmeth_dom_ccd);
								me.set("rfxData.dlvymeth_dom_ccd", rfxInfo.dlvymeth_dom_ccd);
								break;
							case "OVS":
								me.set("rfxData.pymtmeth_ovs_ccd", rfxInfo.pymtmeth_ovs_ccd);
								me.set("rfxData.dlvymeth_ovs_ccd", rfxInfo.dlvymeth_ovs_ccd);
								break;
							default:
								me.set("rfxData.pymtmeth_dom_ccd", rfxInfo.pymtmeth_dom_ccd);
								me.set("rfxData.dlvymeth_dom_ccd", rfxInfo.dlvymeth_dom_ccd);
								me.set("rfxData.pymtmeth_ovs_ccd", rfxInfo.pymtmeth_ovs_ccd);
								me.set("rfxData.dlvymeth_ovs_ccd", rfxInfo.dlvymeth_ovs_ccd);
						}
					}
					if(!UT.isEmpty(param.pr_item_list) && UT.isArray(param.pr_item_list)) {
						me.set("rfxData.rfx_rnd", rfxInfo.rfx_rnd);
						me.set("rfxData.has_pr_item_yn", rfxInfo.has_pr_item_yn);
						me.set("rfxData.has_no_cd_item", rfxInfo.has_no_cd_item);
						me.set("rfxData.pr_uuid", rfxInfo.pr_uuid);

						var rfxItems = UT.copy(param.pr_item_list);
						me.$.itemGridPanel.getDataProvider().addItems(rfxItems);

						if(me.get("rfxData.purc_typ_ccd") === "CONSTSVC") {
							me.computeCntrPrdDate(rfxItems);	//계약 기간 계산
						}
					}else if(!UT.isEmpty(param.upcr_item_list) && UT.isArray(param.upcr_item_list)) {
						me.set("rfxData.rfx_rnd", rfxInfo.rfx_rnd);
						me.set("rfxData.has_upcr_item_yn", rfxInfo.has_upcr_item_yn);
						me.set("rfxData.has_no_cd_item", rfxInfo.has_no_cd_item);
						me.set("rfxData.upcr_uuid", rfxInfo.upcr_uuid);

						var rfxItems = UT.copy(param.upcr_item_list);
						me.$.itemGridPanel.getDataProvider().addItems(rfxItems);

						if(me.get("rfxData.purc_typ_ccd") === "CONSTSVC") {
							me.computeCntrPrdDate(rfxItems);	//계약 기간 계산
						}
					} else {
						me.set("rfxData.is_new", true);
					}

					me.applyFormula();
					me.set('loadCompleted', true);
				} else {
					me.filterComboCodes(param);

					me.set("rfxData.is_new", true);
					me.set("rfxData.rfx_typ_ccd", param.rfx_typ_ccd);

					/*
					//견적마감일 : 일주일 뒤 오후 6시로 설정(SNINEQA-274)
					var nowDate = new Date();
					nowDate.setDate(nowDate.getDate()+7);
					nowDate.setHours(0,0,0,0);
					me.set("rfxData.rfx_clsg_dttm"     , nowDate);
					me.set("rfxData.rfx_clsg_dttm_hour", 18);
					me.set("rfxData.rfx_clsg_dttm_min" , 0);
					*/

					me.applyFormula();
					me.set('loadCompleted', true);
				}
			},

			/**************************************************
			 * 그리드 초기화
			 **************************************************/
			// rfxData.rfx_typ에 따라 협력사 선정방식 code를 filter 처리
			// changeRfxTyp은 이미 rfxData.rfx_typ에 값이 셋팅되었을 때 실행되므로
			// rfxData.rfx_typ_ccd 값이 셋팅되기 전에 filter 처리를 해야함
			filterComboCodes: function(param) {
				var me = this;

				if(me.codes) {
					// 협력사 선정방식
					var prcStlTyp = UT.arrayFilterChange(me.codes.slctnTypCcd, {key: "cstr_cnd_val", value: param.rfx_typ_ccd});
					me.set("codes.prcStlTypFilterCd", prcStlTyp);

					if(UT.isEmpty(param.rfx_uuid) && prcStlTyp.length > 0) {
						me.set("rfxData.slctn_typ_ccd", prcStlTyp[0].data);
					}

					// 계약 유형
					var rfxPurp = me.codes.rfxPurpCcd.filter(function(code) {
						if(code.data !== 'UPRCCNTR_PURC') return true;
					});
					me.set("codes.rfxPurpFilterCcd", rfxPurp);

					if(UT.isEmpty(param.rfx_uuid) && rfxPurp.length > 0) {
						me.set("rfxData.rfx_purp_ccd", rfxPurp[0].data);
					}
				}
			},

			/**************************************************
			 * validation 설정
			 **************************************************/
			//field validator
			//계약 기간
			cntrPeriodValidator: function(value) {
				var me = this;

				if(me.get("rfxData.purc_typ_ccd") === "CONSTSVC") {
					if(UT.isEmpty(value)) {
						return me.translate("STD.E0000");
					}

					var value = UT.toTime(UT.toDate(value, "yyyyMMdd"));
					var nowDate = new Date();
					nowDate.setHours(0, 0, 0, 0);
					var compareValue = UT.toTime(nowDate);
					if(value < compareValue) {
						// {0}은(는) {1}이후 날짜로 입력하십시오
						return me.translate("STD.E1013", null, me.translate("계약 기간"), UT.formatDate(compareValue));
					}
				}
				me.$.cntrPeriod.clearInvalid();
				return true;
			},
			//RFx 사전심사 시작일시 validator
			rpiStartDtValidator: function(value) {
				var me = this;
				var rfxData = me.getRfxData();

				//RFX 일정 valid
				var rfxStartTime = UT.toTime(rfxData.rfx_presn_st_dttm);
				var nowDate = new Date();

				if(rfxStartTime === null || rfxStartTime <= nowDate.getTime()) {
					return me.translate("STD.E1013", null, me.translate("사전심사 시작 일시"), me.translate("현재 일시"));
				}
				return true;
			},
			//RFx 사전심사 종료일시 validator
			rpiEndDtValidator: function(value) {
				var me = this;
				var rfxData = me.getRfxData();

				var rfxEndTime = UT.toTime(rfxData.rfx_clsg_dttm);
				var startTime = UT.toTime(rfxData.rfx_presn_st_dttm);
				var endTime = UT.toTime(rfxData.rfx_presn_clsg_dttm);

				//RFX 일정 valid
				//즉시 시작이면
				if(rfxData.immed_rfx_presn_st_use_yn === "Y") {
					var nowDate = new Date();

					//종료일시 > 현재일시
					if(endTime === null || endTime <= nowDate.getTime()) {
						return me.translate("STD.E1013", null, me.translate("사전심사 종료 일시"), me.translate("현재 일시"));
					} else if(endTime > rfxEndTime) {
						// {0}은(는) {1} 이전 날짜로 입력하십시오
						return me.translate("STD.E1014", null, me.translate("사전심사 종료 일시"), me.translate("RFX 종료 일시"));
					}
				} else {
					if(endTime === null || startTime >= endTime) {
						return me.translate("STD.E1013", null, me.translate("사전심사 종료 일시"), me.translate("RFX 시작 일시"));
					} else if(endTime > rfxEndTime) {
						return me.translate("STD.E1014", null, me.translate("사전심사 종료 일시"), me.translate("RFX 종료 일시"));
					}
				}
				return true;
			},
			//RFx 시작일시 validator
			rfxStartDtValidator: function(value) {
				var me = this;
				var rfxData = me.getRfxData();

				//RFX 일정 valid
				var rfxStartTime = UT.toTime(rfxData.rfx_st_dttm);
				var nowDate = new Date();

				if(rfxStartTime === null || rfxStartTime <= nowDate.getTime()) {
					return me.translate("STD.E1013", null, me.translate("RFX 시작 일시"), me.translate("현재 일시"));
				}
				return true;
			},
			//RFx 종료일시 validator
			rfxCloseDtValidator: function(value) {
				var me = this;
				var rfxData = me.getRfxData();

				var rfxStartTime = UT.toTime(rfxData.rfx_st_dttm);
				var rfxCloseTime = UT.toTime(rfxData.rfx_clsg_dttm);

				//RFX 일정 valid
				//즉시 시작이면
				if(rfxData.immed_st_use_yn === "Y") {
					var nowDate = new Date();

					//종료일시 > 현재일시
					if(rfxCloseTime === null || rfxCloseTime <= nowDate.getTime()) {
						return me.translate("STD.E1013", null, me.translate("RFX 종료 일시"), me.translate("현재 일시"));
					}
				} else {
					if(rfxCloseTime === null || rfxStartTime >= rfxCloseTime) {
						return me.translate("STD.E1013", null, me.translate("RFX 종료 일시"), me.translate("RFX 시작 일시"));
					}
				}
				return true;
			},
			//개찰일시 validator
			openDtValidator: function(value) {
				var me = this;
				var rfxData = me.getRfxData();

				var openDateTime = UT.toTime(rfxData.open_dttm);
				var rfxCloseTime = UT.toTime(rfxData.rfx_clsg_dttm);

				//개찰일시는 RFx 종료일시 이후여야 함
				if(openDateTime === null || openDateTime <= rfxCloseTime) {
					return me.translate("STD.E1013", null, me.translate("개찰 일시"), me.translate("RFX 종료 일시"));
				}
				return true;
			},
			//공고일시 validator
			/*
			notiDtValidator: function(value) {
				var me = this;
				var rfxData = me.getRfxData();

				var notiDateTime = UT.toTime(UT.toDate(value, "yyyyMMdd"));
				var nowDate = new Date();
				nowDate.setHours(0,0,0,0);
				var nowDateTime = UT.toTime(nowDate);

				//공고일시는 현재일시 이후여야 함
				if(notiDateTime === null || notiDateTime < nowDateTime) {
					return me.translate("STD.E1013", null, me.translate("공고 일자"), me.translate("현재 일시"));
				}

				//RFx 즉시시작인 경우
				if(rfxData.immed_st_use_yn === "Y") {
					//공고일시는 RFx 종료일시보다 이전이어야 함
					var rfxCloseTime = UT.toTime(rfxData.rfx_clsg_dttm);
					if(notiDateTime >= rfxCloseTime) {
						return me.translate("STD.E1014", null, me.translate("공고 일자"), me.translate("RFX 종료 일시"));
					}
				}else{
					//공고일시는 RFx 시작일시보다 이전이어야 함
					var rfxStartTime = UT.toTime(rfxData.rfx_st_dttm);
					if(notiDateTime >= rfxStartTime) {
						return me.translate("STD.E1014", null, me.translate("공고 일자"), me.translate("RFX 시작 일시"));
					}
				}
				return true;
			},
			*/
			// 평가비율-가격 validator
			prcEvalRateValidator: function(value) {
				var me = this;
				// 1차수 RFP일 때에만
				if(me.formula('isRfxTypRFP') && me.formula('firstRoundEditable')) {
					var prcEvalRate = new BigNumber(value || 0);
					if(prcEvalRate.isZero()) {
						return me.translate("STD.E1008", null, me.translate("가격평가 비율"), 0);	// '{0}'은(는) '{1}'보다 큰값을 입력해야 합니다.

						// prcEvalRate >= 100
					} else if(prcEvalRate.gte(new BigNumber("100"))) {
						return me.translate("STD.E1010", null, me.translate("가격평가 비율"), 100);	// '{0}'은(는) '{1}'보다 작은값을 입력해야 합니다.
					}

					// 소수점 체크
					if(!CCPrecManager.validate("integer", prcEvalRate.toFixed())) {
						return me.translate("STD.E1021", null, CCPrecManager.validateInfo("integer").decimalprecision);
					}
				}
				return true;
			},
			//현장설명회일시 validator
			rfpDescDtValidator: function(value) {
				var me = this;
				var rfxData = me.getRfxData();

				//1차수일 때에만
				if(me.formula('firstRoundEditable') && me.rfxData.bfg_yn === "Y") {
					var rfpDescDateTime = UT.toTime(rfxData.bfg_dttm);
					//즉시시작이면 RFx 종료일시보다 이전이어야 함
					if(rfxData.immed_open_use_yn === "Y") {
						var rfxCloseTime = UT.toTime(rfxData.rfx_clsg_dttm);
						if(rfpDescDateTime === null || rfpDescDateTime >= rfxCloseTime) {
							return me.translate("STD.E1014", null, me.translate("현장설명회 일시"), me.translate("RFX 종료 일시"));
						}
					} else {
						//즉시시작이 아니면 개찰일시보다 이전이어야 함
						var openDateTime = UT.toTime(rfxData.open_dttm);
						if(rfpDescDateTime === null || rfpDescDateTime >= openDateTime) {
							return me.translate("STD.E1014", null, me.translate("현장설명회 일시"), me.translate("개찰 일시"));
						}
					}
				}
				return true;
			},
			//제안발표설명회날짜
			rfpAnnPeriodValidator: function(value) {
				var me = this;

				//1차수 데이타인 경우
				if(me.formula('firstRoundEditable') && me.rfxData.presn_yn === "Y") {
					var geDate = new Date();
					geDate.setHours(0, 0, 0, 0);
					var geDateCompare = function(compare, value) {
						if(UT.isEmpty(value)) {
							return true;
						}

						var value = UT.toTime(UT.toDate(value, "yyyyMMdd"));
						var compareValue = UT.toTime(compare);

						if(value < compareValue) {
							// {0}은(는) {1}이후 날짜로 입력하십시오
							//return me.translate("STD.E1013", null, me.translate(headerText), UT.formatDate(compareValue));
							return false;
						}
						return true;
					};
					return geDateCompare(geDate, value);
				} else {
					return true;
				}
			},
			//자동 연장 여부 validator
			autoExtTimeValidator: function(value) {
				var me = this;

				if(UT.isEmpty(value)) {
					return me.translate("STD.E0000");
				}
				return true;
			},
			//유효성 검증 함수
			isValid: function() {
				var me = this;

				//일반 정보 체크
				if(!me.validate('rfxInfo')) {
					return false;
				}
				//rfx사전심사 즉시시작이면
				if(me.rfxData.immed_rfx_presn_st_use_yn === "Y") {
					//RFx 사전심사종료일시 체크
					if(!me.validate('rpiEndDt')) {
						return false;
					}
				} else {
					//RFx 사전심사시작일시, 사전심사 종료일시 체크
					if(!me.validate('rpiStartDt') || !me.validate('rpiEndDt')) {
						return false;
					}
				}

				//즉시 시작이면
				if(me.rfxData.immed_st_use_yn === "Y") {
					//RFx 종료일시 체크
					if(!me.validate('rfxCloseDt')) {
						return false;
					}
				} else {
					//RFx 시작일시, 종료일시 체크
					if(!me.validate('rfxStartDt') || !me.validate('rfxCloseDt')) {
						return false;
					}
				}

				//즉시개찰이 아닌경우
				if(me.rfxData.immed_open_use_yn === "N") {
					//개찰일시 체크
					if(!me.validate('openDt')) {
						return false;
					}
				}

				/*
				//공고게시 시
				if(me.rfxData.noti_yn === "Y") {
					//공고일시 체크
					if(!me.validate('notiDt')) {
						return false;
					}
				}
				*/

				//마감시간 연장 시
				if(me.rfxData.auto_ext_use_yn === "Y") {
					//자동연장 체크
					if(!me.validate('autoExtTime')) {
						return false;
					}
				}

				//1차수 데이타인 경우
				if(me.formula('firstRoundEditable')) {
					//개찰일 이전, 오늘날짜 이후에 수행

					//제안발표회 여부
					if(me.rfxData.presn_yn === "Y") {
						//rfpAnnPeriodValidator
						if(!me.$.rfpAnnPeriod.validate()) {
							return false;
						}
					}
					//현장설명회 여부
					if(me.rfxData.bfg_yn === "Y") {
						if(!me.validate("rfpDescDt")) {
							return false;
						}
					}
				}

				//그리드 validator 함수 호출
				if(!me.$.itemGridPanel.validate()) {
					UT.alert("STD.N1102");
					return false;
				}
				if(!me.$.vdGridPanel.validate()) {
					UT.alert("STD.RFX1083");
					return false;
				}

				return true;
			},
			//grid validator-function
			gridValidatorFn: function(headerText, dataField, data) {
				var me    = this,
					value = data[dataField];

				// 요청 납품 일자/공사 시작 일자/공사 종료 일자
				if(["req_dlvy_dt", "const_st_dt", "const_exp_dt"].indexOf(dataField) > -1) {
					var geDate = new Date();
					geDate.setHours(0, 0, 0, 0);
					var geDateCompare = function(compare, value) {
						if(UT.isEmpty(value)) {
							return true;
						}
						var value = UT.toTime(UT.toDate(value, "yyyyMMdd"));
						var compareValue = UT.toTime(compare);

						if(value === null || compareValue === null) {
							return me.translate("STD.E0000");
						}
						if(value < compareValue) {
							// {0}은(는) {1}이후 날짜로 입력하십시오
							return me.translate("STD.E1013", null, me.translate(headerText), UT.formatDate(compareValue));
						}
						return true;
					};

					if(dataField === "const_exp_dt") {
						geDate = UT.toDate(data["const_st_dt"]);
					}
					return geDateCompare(geDate, value);

					// 수량/RFX 요청 단가/RFX 목표 단가/RFX 제한 단가
				} else if(["rfx_qty", "rfx_req_uprc", "rfx_trg_uprc", "rfx_lmt_uprc"].indexOf(dataField) > -1) {
					var required = true;
					if(dataField === "rfx_req_uprc" || dataField === "rfx_trg_uprc") {	// 는 필수 아님
						required = false;
					} else if(dataField === "rfx_lmt_uprc") {	// 제한단가는 'RFX 제한 단가'일 경우만 필수
						required = me.formula("showLMTColumn");
					}

					// 필수일 경우만 0과 비교 (필수 체크)
					if(required && (new BigNumber(value || 0)).isZero()) {
						return me.translate("STD.E1008", null, me.translate(headerText), 0);	// '{0}'은(는) '{1}'보다 큰값을 입력해야 합니다.
					}

					// 값이 있을 때만 validate (항상 필수가 아니므로)
					if(UT.isNotEmpty(value)) {
						var formatterName, dtlCd;
						if(dataField === "rfx_qty") {
							// UOM 존재 시 단위별 수량 포맷유형, UOM 미존재 시 기본 수량 포맷유형
							formatterName = "qty";
							dtlCd = data["uom_ccd"];
						} else {
							formatterName = "amt";
							dtlCd = me.get("rfxData.cur_ccd");
						}
						if(!CCPrecManager.validate(formatterName, value, dtlCd)) {
							return me.translate("STD.E1021", null, CCPrecManager.validateInfo(formatterName, dtlCd).decimalprecision);	// 이 필드는 소수점 '{0}' 자리까지 입력 가능합니다.
						}
					}
				} else if(dataField === "item_spec") {
					// 구매품목유형: 미등록(무코드) 인 경우 품목 규격 필수 입력
					if(data["item_cd_crn_typ_ccd"] === "CDLS" && UT.isEmpty(value)) {
						// '{0}'은(는) 필수 입력 항목입니다.
						return me.translate("STD.E1001", null, me.translate(headerText));
					}
				}
				return true;
			},
			//그리드 데이터 length 확인
			checkRows: function(saveType) {
				var me = this;

				// PR 없이 생성한 경우, 품목 중복체크
				if(!me.formula("hasPrItem") && !me.formula("hasUpcrItem")  && me.hasDupItems()) {
					// 중복된 '{0}'(이)가 존재합니다.
					var msg = me.translate("STD.E1042", null, me.translate("품목 정보"))
							+ "<br/>[" + me.translate("항번") + "] " + me.dupLnos.toString();
					UT.alert(msg, null, true);
					return false;
				}

				if(saveType !== "tempSave") {
					var itemProvider = me.$.itemGridPanel.getDataProvider();
					if(itemProvider.getItemSize() < 1) {
						UT.alert("STD.PR1002"); //'품목 정보가 없습니다.'
						return false;
					}

					// 협력사전송 또는 결재요청 시
					if(saveType === "directRfxQta" || saveType === "approval") {
						if(me.formula("isPriFactSet") && itemProvider.getNewItems().length > 0) {	// 원가구성 사용 여부: "예" 경우, 품목 신규 건 존재 시
							UT.alert("STD.RFX1064");	//"원가구성항목 설정이 완료되지 않았습니다."
							return false;
						}
						if(me.formula("isTemplateRFQSet") && itemProvider.getNewItems().length > 0) {	// Template입찰설정여부: "예" 경우, 품목 신규 건 존재 시
							UT.alert("STD.BID0003");	 //"Template 입찰 항목 설정이 완료되지 않았습니다."
							return false;
						}

						var compTypCcd = me.get("rfxData.comp_typ_ccd");
						var vdProvider = me.$.vdGridPanel.getDataProvider();
						var vdList = vdProvider.filterItems({multrnd_subj_xcept_yn: "N"});	//제외되지 않은 업체리스트

						if(compTypCcd === "PRICNTR" && vdList.length != 1) {			//경쟁 유형(C) : 수의
							UT.alert("STD.RFX1009");	//"경쟁 방식이 수의계약일 경우 하나의 협력사만 지정이 가능합니다. 협력사수를 확인하여주세요."
							return false;
						} else if(compTypCcd === "CBID" && vdList.length <= 1) {	//경쟁 유형(N) : 지명
							UT.alert("STD.RFX1018");	//"업체를 한개이상 선택하세요."
							return false;
						}
					}
				}
				return true;
			},
			// 품목 중복체크
			hasDupItems: function() {
				var me           = this,
					itemProvider = me.$.itemGridPanel.getDataProvider(),
					items        = itemProvider.getItems(),
					len          = items.length;
				if(len > 1) {
					// 중복체크 대상 컬럼
					var cols = ["disp_item_nm", "item_spec", "uom_ccd"];
					if(me.formula("showMTColumn")) {
						cols.push("req_dlvy_dt", "dlvy_plc");
					} else if(me.formula("showCTColumn")) {
						cols.push("const_st_dt", "const_exp_dt", "dlvy_plc");
					}
					// 두 row 데이터 중복체크
					var isEquals = function(row1, row2, cols) {
						var eq = true;
						for(var i = 0, colsLen = cols.length; i < colsLen; i++) {
							var col = cols[i];
							if(row1[col] !== row2[col]) {
								eq = false;
								break;
							}
						}
						return eq;
					};
					// 중복체크
					var hasDup = false, dupLnos = [];
					for(var i = 0; i < len - 1; i++) {
						var item = items[i];
						for(var j = i + 1; j < len; j++) {
							var compItem = items[j];
							if(isEquals(item, compItem, cols)) {
								hasDup = true;
								if(dupLnos.indexOf(item["rfx_lno"]) === -1)
									dupLnos.push(item["rfx_lno"]);
								dupLnos.push(compItem["rfx_lno"]);
							}
						}
						if(hasDup) break;	// item 기준으로 중복되는 compItem들을 dupLnos에 담음 (item도 포함)
					}
					me.dupLnos = dupLnos;
					return hasDup;
				}
				return false;
			},

			/**************************************************
			 * 버튼 이벤트 및 상세 조회
			 **************************************************/
			// rfx 상세 조회
			findRfxDetail: function() {
				var me = this;

				UT.request(me.$.findRfx);
			},
			// rfx 상세 조회 후 handler
			completeFind: function(el, res) {
				var me = this;
				var lastResponse = res.response;
				var popupFlag = false;

				var rfxData = UT.convertDtToDayHourMin(lastResponse.rfxData);	//date convert
				me.filterComboCodes(rfxData);	//rfxData가 셋팅되기 전에 code filter를 해야함

				if(me.get("rfxData").saveType === "approval") {
					popupFlag = true;
				}
				me.set("rfxData", rfxData);
				me.set("rfxData.rfx_req_amt", rfxData.tot_rfq_amt || 0);

				me.$.itemGridPanel.setDataProvider(lastResponse.rfxItems);	//품목 정보 그리드 셋팅
				me.$.vdGridPanel.setDataProvider(lastResponse.rfxVendors);	//협력사 정보 그리드 셋팅

				me.applyFormula();
				me.set('loadCompleted', true);

				if(me.loadCompleted == true && popupFlag ==  true) {
					me.showPopupApproval(rfxData.rfx_uuid);
				}
			},

			// 요청 품목으로 일반 정보 설정
			findDefaultDataByReqItems: function(param) {
				var me = this;

				me.$.findRfxDefaultDataByReqItemIds.body = {
					rfx_req_rcpt_uuids: param.rfx_req_rcpt_uuids
				};
				UT.request(me.$.findRfxDefaultDataByReqItemIds, function(e, res) {
					var result = res.response;

					me.filterComboCodes(param);	//rfxData가 셋팅되기 전에 code filter를 해야함

					// ui상의 default 값을 기본으로 하고, 조회되어 온 구매요청 정보를 추가로 설정해줌
					var rfxData = UT.copy(me.get("rfxData"));
					rfxData.rfx_typ_ccd = param.rfx_typ_ccd;
					for(var key in result) {
						if(key !== "rfxItems") {
							rfxData[key] = result[key];
						}
					}

					var rfxItems = result.rfxItems;
					var rfxTitle = rfxItems[0].disp_item_nm;
					if(rfxItems.length > 1) {
						rfxTitle = me.translate("STD.N3100", null, rfxTitle, rfxItems.length - 1); //RFx 명 (SNINEQA-274)
					}
					rfxData.rfx_tit = rfxTitle;
					me.set("rfxData", rfxData);

					me.$.itemGridPanel.getDataProvider().addItems(rfxItems);

					if(me.get("rfxData.purc_typ_ccd") === "CONSTSVC") {
						me.computeCntrPrdDate(rfxItems);	//계약 기간 계산
					}

					me.applyFormula();
					me.set('loadCompleted', true);
				});
			},

			// RFI로 부터 넘어온 데이터 조회
			findDefaultDataByRfiItems: function(param) {
				var me = this;

				me.$.itemGridPanel.getDataProvider().removeAll();
				me.$.vdGridPanel.getDataProvider().removeAll();

				me.$.findRfxDefaultDataByRfiId.body = {
					rfi_uuid: param.rfi_uuid,
					rfx_req_rcpt_uuids: param.rfx_req_rcpt_uuids
				};

				UT.request(me.$.findRfxDefaultDataByRfiId, function(e, res) {
					var result = res.response;

					me.filterComboCodes(param);	//rfxData가 셋팅되기 전에 code filter를 해야함

					// ui상의 default 값을 기본으로 하고, 조회되어 온 구매요청 정보를 추가로 설정해줌
					var rfxData = UT.copy(me.get("rfxData"));
					rfxData.rfx_typ_ccd = param.rfx_typ_ccd;
					for(var key in result) {
						if(key !== "rfxItems") {
							rfxData[key] = result[key];
						}
					}

					var rfiData = result.rfiData;
					var rfiItems = result.rfxItems;
					var rfiVendors = result.rfiVendors;

					var rfxTitle = rfiData.rfi_tit;
					rfxData.rfx_tit = rfxTitle;
					me.set("rfxData", rfxData);
					me.set("rfxData.rfi_uuid", rfiData.rfi_uuid);

					me.$.itemGridPanel.getDataProvider().addItems(rfiItems);
					me.$.vdGridPanel.getDataProvider().addItems(rfiVendors);

					if(me.get("rfxData.purc_typ_ccd") === "CONSTSVC") {
						me.computeCntrPrdDate(rfiItems);	//계약 기간 계산
					}

					me.applyFormula();
					me.set('loadCompleted', true);
				})
			},

			findDefaultDataByAiItems: function(param) {
				var me = this;

				me.$.findRfxDefaultDataByAiItemIds.body = param;

				UT.request(me.$.findRfxDefaultDataByAiItemIds, function(e, res) {
					var result = res.response;

					me.filterComboCodes(param);	//rfxData가 셋팅되기 전에 code filter를 해야함

					// ui상의 default 값을 기본으로 하고, 조회되어 온 구매요청 정보를 추가로 설정해줌
					var rfxData = UT.copy(me.get("rfxData"));
					rfxData.rfx_typ_ccd = param.rfx_typ_ccd;

					for(var key in result) {
						if(key !== "rfxItems") {
							rfxData[key] = result[key];
						}
					}

					var rfxItems = result.rfxItems;
					var rfxTitle = rfxItems[0].disp_item_nm;
					if(rfxItems.length > 1) {
						rfxTitle = me.translate("STD.N3100", null, rfxTitle, rfxItems.length - 1); //RFx 명 (SNINEQA-274)
					}
					rfxData.rfx_tit = rfxTitle;
					me.set("rfxData", rfxData);

					me.onAddItemList(rfxItems);

					if(me.get("rfxData.purc_typ_ccd") === "CONSTSVC") {
						me.computeCntrPrdDate(rfxItems);	//계약 기간 계산
					}

					me.applyFormula();
					me.set('loadCompleted', true);
				});
			},

			// 원가구성항목 설정 버튼 클릭 시
			onPriFactSet: function() {
				var me = this;

				if(me.formula('editable')) {
					if(!me.isValid()) {
						UT.alert("STD.E0000");
						return;
					}
					if(!me.checkRows('priFactSet')) {
						return;
					}

					UT.confirm("STD.RFX1061", function() {	//"원가구성항목을 설정하시겠습니까?"
						me.set('rfxData.saveType', 'priFactSet');
						me.onSave();
					});
				} else {
					//진행이후의 건들은 비가격평가설정정보 바로 조회
					var rfx_uuid = me.get("rfxData.rfx_uuid");
					me.showPriFactSet(rfx_uuid);
				}

			},
			// Template 설정 버튼 클릭 시
			onTemplateRFQSet: function() {
				var me = this;

				if(me.formula('editable')) {
					if(!me.isValid()) {
						UT.alert("STD.E0000");
						return;
					}
					if(!me.checkRows('templateRFQSet')) {
						return;
					}

					UT.confirm("STD.BID0007", function() { //Template입찰을 설정하겠습니까?
						me.set('rfxData.saveType', 'templateRFQSet');
						me.onSave();
					});
				} else {
					//진행이후의 건들은 비가격평가설정정보 바로 조회
					var rfx_uuid = me.get("rfxData.rfx_uuid");
					me.showBidTemplateSet(rfx_uuid);
				}

			},
			showPriFactSet: function(rfxId, readOnly) {
				var me = this;

				if(UT.isEmpty(me.get("rfxData.rfx_uuid"))) {
					me.set("rfxData.rfx_uuid", rfxId);
				}

				me.fire("show-pri-fact-set-detail", {rfx_uuid: rfxId});
			},
			showBidTemplateSet: function(rfxId, readOnly) {
				var me = this;

				if(UT.isEmpty(me.get("rfxData.rfx_uuid"))) {
					me.set("rfxData.rfx_uuid", rfxId);
				}

				me.fire("show-bid-template-set-detail", {rfx_uuid: rfxId});
			},
			// 비가격 평가 설정 버튼 클릭 시
			onNonPriSet: function() {
				var me = this;

				if(me.formula('editable')) {
					if(!me.isValid()) {
						UT.alert("STD.E0000");
						return;
					}
					if(!me.checkRows('nonPriSet')) {
						return;
					}

					me.set('rfxData.saveType', 'nonPriSet');
					me.onSave();
				} else {
					//진행이후의 건들은 비가격평가설정정보 바로 조회
					var rfx_uuid = me.get("rfxData.rfx_uuid");
					me.showNonPriSet(rfx_uuid);
				}
			},
			// 비가격평가 설정 화면으로 이동
			showNonPriSet: function(rfxId) {
				var me = this;

				if(UT.isEmpty(me.get("rfxData.rfx_uuid"))) {
					me.set("rfxData.rfx_uuid", rfxId);
				}

				me.fire("show-non-pri-set-detail", {'rfx_uuid': rfxId});
			},
			// 저장 버튼 클릭 시
			onTempSave: function() {
				var me = this;

				if(!me.isValid()) {
					UT.alert("STD.E0000");
					return;
				}
				if(!me.checkRows('tempSave')) {
					return;
				}
				me.set('rfxData.saveType', 'tempSave');
				me.onSave();
			},
			// 협력사 전송 버튼 클릭 시
			onReqRfxQta: function() {
				var me = this;

				if(!me.isValid()) {
					UT.alert("STD.E0000");
					return;
				}
				if(!me.checkRows('directRfxQta')) {
					return;
				}

				if((me.get("rfxData.rfx_typ_ccd") === "RFP" && me.get("rfxData.slctn_typ_ccd") === "COMPREVAL") || me.formula("isPriFactSet")) {
					me.checkBeforeRequestRfx('directRfxQta');	//비가격평가 설정 확인
				} else {
					UT.confirm("STD.N1110", function() { //"협력사에게 발신하시겠습니까?"
						me.set('rfxData.saveType', 'directRfxQta');
						me.onSave();
					});
				}
			},
			//즉시 협력사 전송 처리
			directRfxQta: function(rfxId) {
				var me = this;
				me.set("rfxData.rfx_uuid", rfxId);

				me.$.directRfxQta.body = {rfx_uuid: rfxId};

				//즉시 구매 요청 request를 날린다.
				UT.request(me.$.directRfxQta);
			},
			//즉시 협력사 전송 처리 후 handler
			completeDirectRfxQta: function(e, res) {
				var me = this;
				var lastResponse = res.response;

				if(lastResponse.resultStatus === "S") {
					UT.alert("STD.RFX1050", function() {	//"협력사로 발신이 완료되었습니다."
						var rfxId = lastResponse.resultData.rfx_uuid;
						me.set("searchParam.rfx_uuid", rfxId);

						me.findRfxDetail();	//상세조회
					});
				} else {
					UT.alert("STD.E9999");
				}
			},
			//결재 요청 버튼 클릭시
			onReqApprovalBtn: function() {
				var me = this;

				if(!me.isValid()) {
					UT.alert("STD.E0000");
					return;
				}
				if(!me.checkRows("approval")) {
					return;
				}

				if((me.get("rfxData.rfx_typ_ccd") === "RFP" && me.get("rfxData.slctn_typ_ccd") === "COMPREVAL") || me.formula("isPriFactSet")) {
					me.checkBeforeRequestRfx("approval");	//비가격평가 설정 확인
				} else {
					UT.confirm("STD.PR1007", function() {	//"결재요청 하시겠습니까?"
						me.set("rfxData.saveType", "approval");
						me.onSave();
					});
				}
			},
			// 결재 작성 팝업 호출
			showPopupApproval: function(rfxId) {
				var me = this;

				// 결재팝업 호출
				UT.popupApproval(me, {
							task_uuid: rfxId, apvl_typ_ccd: me.apvlTypCcd, apvl_tit: me.get("rfxData.rfx_tit"),
							appData: me.get("rfxData"),
							appAmt: me.get("rfxData.rfx_req_amt")
						},
						// savedCallback (결재 팝업에서 이벤트 처리후 실행되는 callback 함수 내용을 정의한다.)
						function(sts, popup) {
							if(sts === "APVD") {	// 결재상신 시
								me.onClose();
							} else {			// 결재 저장 시
								me.set("searchParam.rfx_uuid", rfxId);

								me.findRfxDetail();
							}
						});
			},
			// 복사 버튼 클릭 시
			onCopyRfx: function() {
				var me = this;

				UT.confirm("STD.N2100", function() {	//복사 하시겠습니까?
					UT.request(me.$.copyRfx);
				});
			},
			// 복사 처리 후 handler
			completeCopyRfx: function(e, res) {
				var me = this;
				var lastResponse = res.response;

				if(lastResponse.resultStatus === "S") {
					UT.alert("STD.N2600");								//"복사하였습니다."
					var rfxId = lastResponse.resultData.rfx_uuid;
					me.set("searchParam.rfx_uuid", rfxId);

					me.findRfxDetail();
				} else {
					UT.alert("STD.E9999");
				}
			},
			// 삭제 버튼 클릭 시
			onDelete: function() {
				var me = this;

				UT.confirm("STD.N1300", function() {
					UT.request(me.$.deleteRfx);
				});
			},
			// 삭제 처리 후 handler
			completeDeleteRfx: function(e, res) {
				var me = this;
				var lastResponse = res.response;

				if(lastResponse.resultStatus === "S") {
					UT.alert("STD.N2500");	//"삭제하였습니다."
					me.onClose();

				} else if(lastResponse.resultStatus === "INVALID_STATUS_ERR") {
					UT.alert("STD.E9400");	// 유효한 상태가 아니거나 상태가 변경되어 요청을 수행할 수 없습니다.
					me.findRfxDetail();

				} else {
					UT.alert("STD.E9999");
				}
			},
			// 취소 버튼 클릭 시
			onCancelRfx: function() {
				var me = this;

				UT.confirm("STD.RFX1036", function() {
					UT.request(me.$.cancelRfx);
				});
			},
			// 취소 처리 후 handler
			completeCancelRfx: function(e, res) {
				var me = this;
				var lastResponse = res.response;

				if(lastResponse.resultStatus === "S") {
					UT.alert("STD.RFX1048");	//"취소 처리 하였습니다."
					me.onClose();

				} else if(lastResponse.resultStatus === "INVALID_STATUS_ERR") {
					UT.alert("STD.E9400");	// 유효한 상태가 아니거나 상태가 변경되어 요청을 수행할 수 없습니다.
					me.findRfxDetail();

				} else {
					UT.alert("STD.E9999");
				}
			},
			// 비가격평가 설정, 원가구성항목 설정 확인
			checkBeforeRequestRfx: function(saveType) {
				var me = this;

				// 아직 저장한 적이 없는 경우
				if(UT.isEmpty(me.get("rfxData.rfx_uuid"))) {
					if(me.get("rfxData.rfx_typ_ccd") === "RFP" && me.get("rfxData.slctn_typ_ccd") === "COMPREVAL") {
						UT.alert("STD.RFX1042");	//"비가격평가기준 설정정보가 없습니다.<br/>평가기준을 먼저 설정하세요."
					} else if(me.formula("isPriFactSet")) {
						UT.alert("STD.RFX1064");	//"원가구성항목 설정이 완료되지 않았습니다."
					}
				} else {
					me.set("rfxData.saveType", saveType);

					me.$.checkBeforeRequestRfx.body = {
						rfxData: me.get('rfxData')
					};
					UT.request(me.$.checkBeforeRequestRfx, function(e, res) {
						var lastResponse = res.response;

						if(lastResponse.resultStatus === "S") {
							var saveType = me.rfxData.saveType;
							var message = null;
							if(saveType === 'directRfxQta') {
								message = "STD.N1110";	//"협력사 발신하시겠습니까?"
							} else if(saveType === 'approval') {
								message = "STD.PR1007";	//"결재요청 하시겠습니까?"
							}
							UT.confirm(message, function() {
								me.onSave();
							});
						} else if(lastResponse.resultStatus === "INVALID_STATUS_ERR") {
							UT.alert("STD.E9400");	// 유효한 상태가 아니거나 상태가 변경되어 요청을 수행할 수 없습니다.
							me.findRfxDetail();
						} else if(lastResponse.resultStatus === "RFX_PRI_FACT_SET_INCOMPELETED") {
							UT.alert("STD.RFX1064");	//"원가구성항목 설정이 완료되지 않았습니다."
							return;
						} else if(lastResponse.resultStatus === "RFP_NON_PRI_EVAL_SET_INCOMPELETED") {
							UT.alert("STD.RFX1042");	//"비가격평가기준 설정정보가 없습니다.<br/>평가기준을 먼저 설정하세요."
							return;
						} else if(lastResponse.resultStatus === "RFP_NON_PRI_EVAL_SET_NOT_CONFIRM") {
							UT.alert("STD.RFX1208");	//"비가격평가기준이 확정되지 않았습니다.<br/>평가기준 확정처리를 먼저 설정하세요."
							return;
						} else if(lastResponse.resultStatus === "RFP_NO_EVALUATOR") {
							UT.alert("STD.RFX1043");	//"비가격평가 담당자 정보가 없습니다.<br/>비가격평가기준에서 평가자를 설정하세요."
							return;
						} else {
							UT.alert("STD.E9999");
							return;
						}
					});
				}
			},
			//저장
			onSave: function() {
				var me = this;

				Promise.all([me.$.upload_in.upload(), me.$.upload_out.upload()]).then(function() {
					var rfxData = me.getRfxData();
					var itemProvider = me.$.itemGridPanel.getDataProvider();
					var vdProvider = me.$.vdGridPanel.getDataProvider();

					if(rfxData.immed_st_use_yn === "Y") {
						rfxData.rfx_st_dttm = '';
					}

					me.$.saveRfx.body = {
						rfxData: rfxData,
						insertRfxItems: itemProvider.getNewItems(),
						updateRfxItems: itemProvider.getUpdateItems(),
						deleteRfxItems: itemProvider.getRemoveItems() || [],
						insertRfxVendors: vdProvider.getNewItems(),
						updateRfxVendors: vdProvider.getUpdateItems(),
						deleteRfxVendors: vdProvider.getRemoveItems() || [],
						prItemIds: UT.getArrayValuesByKey(itemProvider.getItems(), "pr_item_uuid"),
						upcrItemIds: UT.getArrayValuesByKey(itemProvider.getItems(), "upcr_item_uuid"),
						srItemIds: UT.getArrayValuesByKey(itemProvider.getItems(), "sr_item_uuid")
					};
					UT.request(me.$.saveRfx);
				});
			},
			// 저장 후 handler
			completeSaveRfx: function(el, res) {
				var me = this;
				var lastResponse = res.response,
					status       = lastResponse.resultStatus;

				if(status === "S") {
					var rfxId = lastResponse.resultData.rfx_uuid;
					me.set("searchParam.rfx_uuid", rfxId);

					var saveType = me.rfxData.saveType;
					if(saveType == 'tempSave') {
						UT.completeAlert();
						me.findRfxDetail();		//재조회
					} else if(saveType === 'approval') {
						me.findRfxDetail();		//재조회
						// me.showPopupApproval(rfxId);	//결재요청 팝업 호출
					} else if(saveType === 'directRfxQta') {
						me.directRfxQta(rfxId);			//데이터 저장 후 즉시 협력사 전송
					} else if(saveType === 'nonPriSet') {
						me.findRfxDetail();		//재조회
						me.showNonPriSet(rfxId);		//데이터 저장 후 비가격평가항목 설정 화면 호출
					} else if(saveType === 'priFactSet') {
						me.showPriFactSet(rfxId);
					} else if(saveType === 'templateRFQSet') {
						me.showBidTemplateSet(rfxId);
					}
				} else if(status === "PR_ITEM_STS_ERR") {
					var resultData     = lastResponse.resultData,
						invalidPrItems = resultData.invalid_datas || [],
						notExistIds    = resultData.not_exist_ids || [];

					// STD.E9400 : "유효한 상태가 아니거나 상태가 변경되어 요청을 수행할 수 없습니다."
					var msg = me.translate("STD.E9400");

					invalidPrItems.forEach(function(invalidPrItem) {
						// [구매요청 번호 : {0}, 항번 : {1}] 은(는) '{2}' 상태입니다.
						msg += "<br/>" + me.translate("STD.PR1035", null, invalidPrItem.pr_no, invalidPrItem.pr_lno, invalidPrItem.pr_prog_sts_nm);
					});

					if(notExistIds.length > 0) {
						var checkedRows = me.$.itemGridPanel.getDataProvider().selectionCheckedItems();
						notExistIds.forEach(function(notExistId) {
							var notExistItem = null;
							checkedRows.forEach(function(row) {
								if(row.pr_item_uuid === notExistId) {
									notExistItem = row;
								}
							});
							if(notExistItem) {
								// [구매요청 번호 : {0}, 항번 : {1}] 은(는) 삭제되었거나 존재하지 않는 데이터입니다.
								msg += "<br/>" + me.translate("STD.PR1037", null, notExistItem.pr_no, notExistItem.pr_lno);
							}
						});
					}
					UT.alert(msg, null, true);
				} else if(status === "UPCR_ITEM_STS_ERR") {
					var resultData     = lastResponse.resultData,
						invalidPrItems = resultData.invalid_datas || [],
						notExistIds    = resultData.not_exist_ids || [];

					// STD.E9400 : "유효한 상태가 아니거나 상태가 변경되어 요청을 수행할 수 없습니다."
					var msg = me.translate("STD.E9400");

					invalidPrItems.forEach(function(invalidPrItem) {
						// [단가계약요청 번호 : {0}, 항번 : {1}] 은(는) '{2}' 상태입니다.
						msg += "<br/>" + me.translate("STD.UPCR0002", null, invalidPrItem.upcr_no, invalidPrItem.upcr_lno, invalidPrItem.upcr_prog_sts_nm);
					});

					if(notExistIds.length > 0) {
						var checkedRows = me.$.itemGridPanel.getDataProvider().selectionCheckedItems();
						notExistIds.forEach(function(notExistId) {
							var notExistItem = null;
							checkedRows.forEach(function(row) {
								if(row.upcr_item_uuid === notExistId) {
									notExistItem = row;
								}
							});
							if(notExistItem) {
								// [단가계약요청 번호 : {0}, 항번 : {1}] 은(는) 삭제되었거나 존재하지 않는 데이터입니다.
								msg += "<br/>" + me.translate("STD.UPCR0001", null, notExistItem.upcr_no, notExistItem.pr_lno);
							}
						});
					}
					UT.alert(msg, null, true);
				} else if(status === "INVALID_STATUS_ERR") {
					UT.alert("STD.E9400");	// 유효한 상태가 아니거나 상태가 변경되어 요청을 수행할 수 없습니다.
					me.findRfxDetail();

				} else {
					UT.alert("STD.E9999");
				}
			},
			getRfxData: function() {
				var me = this;
				return UT.convertDayHourMinToDt(me.get("rfxData"));
			},
			// 결과상세 이동
			onShowResultDetail: function() {
				var me = this;

				me.fire("show-result-detail", {rfx_uuid: me.get("rfxData.rfx_uuid")});
				me.clearData();
			},
			// 닫기 버튼
			onClose: function() {
				var me = this;

				me.clearData();
				me.fire('close');
			},
			// 데이터 초기화
			clearData: function() {
				var me = this;

				//데이터 clear 이전에 초기화 해주어야 함
				me.set('loadCompleted', false);

				//properties 초기화 및 grid provider 초기화
				me.reset();
			},

			onPopupFieldIntroList: function() {
				var me = this;
				var fieldIntroListPopup = UT.popup("ep-fi-list", me, 1000, 500, {
					'selected-item': function(popup, e) {
						var result  = e.detail,
							info    = result.fiData,
							items   = result.items,
							vendors = result.vendors;

						// 현장 설명회 정보 추가
						me.set("rfxData.sitebrfg_no", info.sitebrfg_no);
						me.set("rfxData.sitebrfg_uuid", info.sitebrfg_uuid);
						me.set("rfxData.sitebrfg_tit", info.sitebrfg_tit);
						//me.set("rfxData.sitebrfg_inp_use_yn", "N");
						me.set("rfxData.bfg_dttm", info.sitebrfg_st_dttm);
						me.set("rfxData.bfg_dttm_hour", info.sitebrfg_st_dttm.getHours());
						me.set("rfxData.bfg_dttm_min", info.sitebrfg_st_dttm.getMinutes());
						me.set("rfxData.bfg_plc", info.sitebrfg_plc);
						me.set("rfxData.bfg_pic_id", info.sitebrfg_pic_id);
						me.set("rfxData.bfg_pic_nm", info.sitebrfg_pic_nm);

						// PR UPCR 품목 여부
						if(!me.formula('hasPrItem') && !me.formula("hasUpcrItem")) {
							var itemProvider = me.$.itemGridPanel.getDataProvider();
							itemProvider.removeAll();
							me.set("rfxData.has_no_cd_item", "N");

							var rfxItemLno  = me.getNewItemLno(itemProvider),
								defaultUnit = me.codes.uomCcd.length > 0 ? me.codes.uomCcd[0].data : null;

							items.forEach(function(el) {
								el["rfx_lno"] = rfxItemLno;
								el["oorg_cd"] = me.rfxData.oorg_cd;
								el["purc_typ_ccd"] = me.rfxData.purc_typ_ccd;
								el["rfx_purp_ccd"] = me.rfxData.rfx_purp_ccd;
								el["cur_ccd"] = me.rfxData.cur_ccd;
								el["uom_ccd"] = defaultUnit;
								el["rfx_req_uprc"] = 0;
								el["rfx_req_amt"] = 0;
								el["rfx_qty"] = 1;
								el["auto_po_yn"] = "N";
								el["slctn_qty"] = 0;
								rfxItemLno += 10;

								// 무코드 품목 존재 여부 => 구매 품목 유형으로 판단 (P093 : 구매품목유형(T : 미등록, R 등록)
								if(el.item_cd_crn_typ_ccd === "CDLS") {
									me.set("rfxData.has_no_cd_item", "Y");
								}
							});
							itemProvider.addItems(items);
							me.applyFormula("hasNoCdItem");

							// 업체 추가
							me.$.vdGridPanel.getDataProvider().removeAll();
							me.$.vdGridPanel.getDataProvider().addItems(vendors);
						}

						me.applyFormula('isFieldIntro');
						popup.close();
					}
				}, {titleText: "현장설명회 조회"});
				fieldIntroListPopup.show();
				fieldIntroListPopup.getWindowContent().load();
			},

			// 현장 설명회 상세정보 팝업
			onPopupFieldIntroInfo: function() {
				var me = this;
				var fieldIntroInfoPopup = UT.popup("ep-fi-detail", me, 1240, 500, null, {titleText: "현장설명회정보"});
				fieldIntroInfoPopup.show();
				fieldIntroInfoPopup.getWindowContent().load({sitebrfg_uuid: me.rfxData.sitebrfg_uuid});

			},

			/**************************************************
			 * 그리드 이벤트
			 **************************************************/
			// grid item click 이벤트
			onItemClick: function(event) {
				var me = this;
				var data     = event.detail.data,
					item     = event.detail.item,
					provider = event.detail.provider;

				if(item.dataField === "img_item_cd" && data["item_cd_crn_typ_ccd"] === "ITEM_CD") {			// 품목
					me.showItemContractHistory(data["item_cd"]);

				} else if(item.dataField === "img_purc_grp") {									// 구매그룹
					if(me.formula('firstRoundEditable')) {
						me.rowIndex = item.rowIndex;

						me.showJobPopup();
					}
				} else if(item.dataField === "upcr_no") {												// UPCR
					me.fire('show-upcr-detail', {upcr_uuid: data.upcr_uuid, pageType: "VIEW"});
				} else if(item.dataField === "pr_no") {												// PR
					me.fire('show-pr-detail', {pr_uuid: data.pr_uuid, pageType: "VIEW"});
				} else if(item.dataField === "sr_no") {												// PR
					me.fire('show-sr-detail', {sr_uuid: data.sr_uuid});
				} else if(item.dataField === "img_item_spec_dtl" && data["item_cd_crn_typ_ccd"] === "CDLS") {	// 품목 규격 상세(미등록 품목인 경우)
					//현재 row 인덱스를 담아둔다.
					me.rowIndex = item.rowIndex;

					me.showDetailSpec(data, provider);
				} else if(item.dataField === 'img_plant_select' && (UT.isNotEmpty(data["item_cd_crn_typ_ccd"]) && data["item_cd_crn_typ_ccd"] === 'CDLS')){
					// 팝업 호출
					UT.popupOperOrgLinkSearch(me,me.rfxData.oorg_cd,'POIO',function(selectedItems) {
						provider.setItemAt(item.rowIndex, {
							"plt_cd": selectedItems[0].org_cd,
							"item_oorg_cd": selectedItems[0].oorg_cd,
							"plt_nm": selectedItems[0].logic_org_nm
						});
					});
				}
			},
			// 그리드 item-style-function
			onItemStyleFn: function(data, item) {
				var me       = this,
					styleObj = {};

				if(item.dataField === "item_spec" && me.onItemEditableFn(data, item)) {
					styleObj = {
						iconLocation: "leftSide",
						iconOffset: 0,
						iconPadding: 0,
						paddingLeft: 0,
						paddingTop: 0,
						iconUrl: "bower_components/sc-grid/resources/img/icon_required.png"
					};
				}
				return styleObj;
			},
			// 그리드 image-change-function
			onImageChangeFn: function(data, item) {
				if(item.dataField === "img_item_cd" && data["item_cd_crn_typ_ccd"] === "ITEM_CD") {
					return "link";
				} else if(item.dataField === "img_item_spec_dtl" && data["item_cd_crn_typ_ccd"] === "CDLS") {	// 품목 규격 상세(미등록 품목인 경우)
					return "link";
				}
				return null;
			},
			onVdItemClick: function(event) {
				var me = this;

				var data     = event.detail.data,
					item     = event.detail.item,
					provider = event.detail.provider;

				if(item.dataField === "img_multrnd_xcept_rsn") {
					me.set("selectedVdItemIndexes", [item.rowIndex]);

					if(data["multrnd_subj_xcept_yn"] === "Y") {
						me.$.dialog_multrnd_xcept_rsn_text.value = data.multrnd_xcept_rsn;
						me.$.dialog_multrnd_xcept_rsn.show();
					}
				} else if(item.dataField === "img_vd_cd") {
					me.showVendorContractHistory(data["vd_cd"]);

				} else if(item.dataField === "rcmd_cnt" && data["auto_rcmd_vd_yn"] === "Y") {

					var param = {
						"rcmdList": data.rcmdList,
						"readonly": true
					};
					me.showRcmdOptionPopup(param, {"titleText": "추천 유형 상세"});
				}
			},
			onConvertSbmtYn: function(rowIndex, dataField, data) {
				// 이전차수 제출여부
				if(dataField === "sbmt_yn") {
					return UT.isEmpty(data["rfx_bid_uuid"]) ? "N" : "Y";
				}
			},
			onConverterRcmdCnt: function(rowIndex, dataField, data) {
				// 업체 추천 수
				if(dataField === "rcmd_cnt") {
					return UT.isNotEmpty(data["rcmdList"]) && UT.isArray(data["rcmdList"]) ? data["rcmdList"].length : 0;
				}
			},
			onVdItemStyleFn: function(data, item) {
				var styleObj = {};

				// 업체 추천 수가 0 이상일 때
				if(item.dataField === "rcmd_cnt" && data.rcmd_cnt > 0) {
					styleObj.fontColor = "#ff111111";
					styleObj.fontWeight = "bold";
				}
				return styleObj;
			},
			onVdExcImageChangeFn: function(data, item) {
				// 제외 여부 : "Y" 인 협력사만 아이콘 보이도록 함
				if(data["multrnd_subj_xcept_yn"] === "Y") {
					return "link";
				} else {
					return null;
				}
			},
			onShowVendorMailWorkHistory: function() {
				var me = this;

				var rfxId = me.get("searchParam.rfx_uuid");
				var vdMailWorkHistoryPopup = null;
				if(vdMailWorkHistoryPopup == null) {
					vdMailWorkHistoryPopup = UT.popup("ep-rfx-mail-work-history", me, "90%", "80%");
				}

				vdMailWorkHistoryPopup.show();
				vdMailWorkHistoryPopup.getWindowContent().load({task_uuid: rfxId});
			},
			// grid item edit end 이벤트
			onItemEditEnd: function(event) {
				var me = this, e = event.detail,
					data         = e.data,
					item         = e.item,
					newValue     = e.newValue,
					oldValue     = e.oldValue,
					provider     = e.provider;

				me.rowIndex = item.rowIndex;

				// 구매그룹
				if(item.dataField === 'purc_grp_nm') {
					provider.setItemAt(item.rowIndex, {purc_grp_cd: ''});

					if(UT.isNotEmpty(newValue)) {
						me.showJobPopup({'purc_grp_nm': newValue}, true);
					}

					// UOM/수량/RFX 요청 단가
				} else if(["uom_ccd", "rfx_qty", "rfx_req_uprc"].indexOf(item.dataField) > -1) {
					var unitCd = data["uom_ccd"],
						qty    = data["rfx_qty"] || 0,
						price  = data["rfx_req_uprc"] || 0;

					// UOM/수량 변경 시
					if(item.dataField === "uom_ccd") {
						// 수량 소수점처리
						qty = CCPrecManager.format("qty", qty, unitCd);
					}

					// 금액 계산 소수점처리
					var amt = CCPrecManager.format("amt", (new BigNumber(qty)).mul(new BigNumber(price)).toFixed(), me.get("rfxData.cur_ccd"));

					provider.setItemAt(item.rowIndex, {
						"rfx_qty": qty,
						"rfx_req_amt": amt
					});

					// 수행기간
				} else if(item.dataField === "const_st_dt" || item.dataField === "const_exp_dt") {
					me.computeCntrPrdDate(provider.getItems()); // 계약 기간 계산
				} else if(item.dataField === "disp_item_nm") {
					provider.setItemAt(item.rowIndex, {
						"item_nm": newValue,
						"item_nm_en": newValue
					});
				}
			},
			// grid column item-editable-function
			onItemEditableFn: function(data, item) {
				if(["req_dlvy_dt", "const_st_dt", "const_exp_dt"].indexOf(item.dataField) > -1) {
					return this.formula('editable');

				} else if (["uom_ccd"].indexOf(item.dataField) > -1) {
					return this.formula('itemAddable');

				} else if(item.dataField === "rfx_qty") {
					return this.formula('firstRoundEditable') && UT.isEmpty(data.pr_item_uuid) && UT.isEmpty(data.upcr_item_uuid);

				} else if(["disp_item_nm", "item_spec", "uom_ccd"].indexOf(item.dataField) > -1) {
					return this.formula("noCdItemAddable") && (data["item_cd_crn_typ_ccd"] === "CDLS");

				} else {
					return this.formula('firstRoundEditable');
				}
			},
			// grid column editor-regex-function
			onRegexFn: function(data, item) {
				var me        = this,
					dataField = item.dataField;

				// 수량
				if(dataField === "rfx_qty") {
					return CCPrecManager.regex("qty", data["uom_ccd"]);

					// RFX 요청 단가/RFX 목표 단가/RFX 제한 단가
				} else if(["rfx_req_uprc", "rfx_trg_uprc", "rfx_lmt_uprc"].indexOf(dataField) > -1) {
					return CCPrecManager.regex("price", me.get("rfxData.cur_ccd"));
				}
			},
			// 금액 합계
			onAmtAggregateFn: function(dataField, datas) {
				var me = this;
				var result = new BigNumber('0');

				for(var i = 0; i < datas.length; ++i) {
					result = result.plus(new BigNumber(datas[i][dataField] || 0));
				}

				var cur_ccd = me.get("rfxData.cur_ccd"),
					value   = result.toFixed();

				// 금액 소수점처리(value)
				me.set("rfxData.rfx_req_amt", CCPrecManager.format("amt", value, cur_ccd));
				return value;
			},
			// 금액 정렬
			onSortCompareFn: UT.sortBigNumber,
			// 구매그룹 팝업 호출
			showJobPopup: function(param, autoComplete) {
				var me = this;

				var defaultParam = {
					co_cd: me.codes.param.co_cd,
					purc_grp_typ_ccd: me.codes.param.purc_grp_typ_ccd	//직무유형이 구매
				};
				if(UT.isObject(param)) {
					for(var keys in param) {
						defaultParam[keys] = param[keys];
					}
				}

				var jobPopup = me.createJobPopup();
				jobPopup.show();
				jobPopup.getWindowContent().load({singleSelect: true, defaultParam: defaultParam, autoComplete: autoComplete});
			},
			// 구매그룹 팝업 생성
			createJobPopup: function() {
				var me = this;

				return UT.popup("ep-job-list", me, 780, 650, {
					'selected-items': function(popup, e) {
						var result   = e.detail,
							selected = result[0];

						var provider = me.$.itemGridPanel.getDataProvider();
						provider.setItemAt(me.rowIndex, {
							'purc_grp_cd': selected.purc_grp_cd,
							'purc_grp_nm': selected.disp_purc_grp_nm
						});
						me.$.itemGridPanel.applyFocus();
						popup.close();
					}
				}, {titleText: me.translate("구매 그룹 검색")});
			},
			getNewItemLno: function(provider) {
				var me = this;
				var maxNo = 10;
				if(provider.getItemSize() > 0) {
					var allRows = provider.getItems();

					var maxRow = allRows.reduce(function(a, b) {
						if(!a.rfx_lno) a.rfx_lno = 0;
						if(!b.rfx_lno) b.rfx_lno = 0;
						return (a.rfx_lno > b.rfx_lno) ? a : b;
					});
					maxNo = parseInt(maxRow.rfx_lno, 10) + 10;
				}
				return maxNo;
			},
			// 무코드품목추가 버튼 클릭 시
			onAddNoCdItem: function() {
				var me = this;

				var rfxData = me.get('rfxData');
				var provider = me.$.itemGridPanel.getDataProvider();
				var rfxItemLno = me.getNewItemLno(provider);
				var defaultUnit = me.codes.uomCcd.length > 0 ? me.codes.uomCcd[0].data : null;

				var addRow = {
					rfx_lno: rfxItemLno,
					oorg_cd: rfxData.oorg_cd,	//운영조직
					purc_typ_ccd: rfxData.purc_typ_ccd,		//구매 유형
					rfx_purp_ccd: rfxData.rfx_purp_ccd,
					cur_ccd: rfxData.cur_ccd,
					uom_ccd: defaultUnit,
					rfx_req_uprc: 0,
					rfx_req_amt: 0,
					rfx_qty: 1,
					auto_po_yn: "N",
					slctn_qty: 0,
					item_cd_crn_typ_ccd: 'CDLS'						//구매품목유형: 미등록
				};
				provider.addItem(addRow);
				me.set("rfxData.has_no_cd_item", "Y");
				me.applyFormula("hasNoCdItem");
				me.applyFormula("noCdItemPlantAddable");
			},
			// 품목 추가 버튼 클릭시
			onShowItemPopup: function() {
				var me = this;

				if(!me.rfxData.oorg_cd) {
					UT.alert("STD.N3400"); //'운영조직 선택하세요.'
					return false;
				}

				var param = {
					oorg_cd: me.rfxData.oorg_cd,
					purc_grp_typ_ccd: me.codes.param.purc_grp_typ_ccd,
					purc_typ_ccd: me.rfxData.purc_typ_ccd
				};

				UT.popupItemSearch(me, param, function(selectedItems) {
					// 품목정보 리스트 추가
					me.onAddItemList(selectedItems);
				});
			},
			// 품목정보 리스트 추가
			onAddItemList: function(selectedList) {
				var me = this;

				if(selectedList.length > 0) {
					var rfxData = me.get('rfxData');
					var provider = me.$.itemGridPanel.getDataProvider();
					var rfxItemLno = me.getNewItemLno(provider);

					for(var i = 0; i < selectedList.length; i++) {
						var selected = selectedList[i];

						var addRow = {
							rfx_lno: rfxItemLno,
							oorg_cd: rfxData.oorg_cd,	//운영조직
							purc_typ_ccd: rfxData.purc_typ_ccd,		//구매 유형
							disp_item_cd: selected.item_cd,
							plt_cd 		: selected.org_cd,
							item_oorg_cd	: selected.oorg_cd,
							plt_nm 		: selected.logic_org_nm,
							item_cd: selected.item_cd,		//품목 코드
							disp_item_nm: selected.disp_item_nm, //디스플레이 품목 명
							item_nm: selected.item_nm,		//품목 명
							item_nm_en: selected.item_nm_en,		//품목 명 영문
							item_spec: selected.item_spec,			//품목 규격
							uom_ccd: selected.uom_ccd,	//UOM (기본단위)
							sg_cd: selected.sg_cd,			//소싱그룹코드
							sg_nm: selected.sg_nm,			//소싱그룹명
							purc_grp_cd: selected.purc_grp_cd,	//구매그룹코드
							purc_grp_nm: selected.purc_grp_nm,	//구매그룹명
							rfx_purp_ccd: rfxData.rfx_purp_ccd,
							cur_ccd: rfxData.cur_ccd,
							rfx_req_uprc: selected.uprccntr_uprc || 0,
							rfx_req_amt: selected.uprccntr_amt || 0,
							rfx_qty: 1,
							auto_po_yn: selected.auto_po_yn,
							slctn_qty: 0,
							item_cd_crn_typ_ccd: 'ITEM_CD'						//구매품목유형: 등록
						};
						provider.addItem(addRow);
						rfxItemLno += 10;
					}
				} else {
					UT.alert("STD.N1600"); // 선택된 항목이 없습니다
				}
			},
			// 일괄 적용 버튼 클릭 시
			onAllApplyBtn: function() {
				var me = this;

				var provider = me.$.itemGridPanel.getDataProvider();
				var selectedIndexes = provider.selectionCheckedIndexes();

				if(selectedIndexes.length > 0) {
					me.showPopupAllApply(selectedIndexes);
				} else {
					UT.alert("STD.N1600"); // 선택된 항목이 없습니다
				}
			},
			// 일괄 적용 팝업 호출
			showPopupAllApply: function(rowIndexes) {
				var me = this;
				me.rowIndexes = rowIndexes;

				//팝업에 load 함수에 파라미터를 셋팅한다.
				var param = {
					purc_grp_typ_ccd: me.codes.param.purc_grp_typ_ccd,
					purc_typ_ccd: me.rfxData.purc_typ_ccd,
					pr_purp: me.rfxData.rfx_purp_ccd,
					hiddenField: {"gr_chr": true, "rfx_qty": (me.formula("hasPrItem") || me.formula("hasUpcrItem")), "uom_ccd": !me.formula("itemAddable")}
				};
				var width = ((me.rfxData.purc_typ_ccd === "QTY") ? 500 : 550);
				var height = 450;

				var applyPopup = UT.popup("ep-apply", me, width, height, {
					'all-apply-items': function(popup, e) {
						me.onAllApplyList(e.detail);	//그리드에 일괄적용
						popup.close();
					},
				}, {titleText: "일괄 적용"});
				applyPopup.show();
				applyPopup.getWindowContent().load(param);
			},
			// 선택된 row에 일괄적용
			onAllApplyList: function(applyValues) {
				var me = this;

				var rowIndexes = me.rowIndexes;
				var provider = me.$.itemGridPanel.getDataProvider();

				var cur_ccd = me.get("rfxData.cur_ccd");
				provider.setItemAtBatch(rowIndexes, function(index, row) { //index: rowIndex, data: row데이터
					var unitCd = applyValues["uom_ccd"] || row["uom_ccd"];
					var price = applyValues["price"] || row["rfx_req_uprc"] || 0;
					var qty = applyValues["qty"] || row["rfx_qty"] || 0;

					var result = UT.copy(applyValues);

					// 수량 일괄적용 데이터 존재 시
					if(applyValues["qty"]) {
						// 수량 소수점처리
						qty = CCPrecManager.format("qty", qty, unitCd);
						result["rfx_qty"] = qty;
					}

					// 단가 일괄적용 데이터 존재 시
					if(applyValues["price"]) {
						// 단가 소수점처리
						price = CCPrecManager.format("price", price, cur_ccd);
						result["rfx_req_uprc"] = price;
						delete result["pr_price"];
					}

					// 금액 계산 소수점처리
					result["rfx_req_amt"] = CCPrecManager.format("amt", (new BigNumber(qty)).mul(new BigNumber(price)).toFixed(), cur_ccd);

					return result;
				});

				if(me.get("rfxData.purc_typ_ccd") === "CONSTSVC") {
					me.computeCntrPrdDate(provider.getItems());	//계약 기간 계산
				}
			},
			// 품목정보 삭제 버튼 클릭시
			onDeleteRfxItem: function() {
				var me = this;

				var provider = me.$.itemGridPanel.getDataProvider();
				var checked = provider.selectionCheckedItems();

				if(checked.length === 0) {
					UT.alert("STD.N1600"); // 선택된 항목이 없습니다
				} else {
					UT.confirm("STD.N1300", function() {	// "삭제 하시겠습니까?"
						provider.removeItems(true);	// 그리드에서 체크된 데이터를 지워준다. getRemoveItems에서 지워진 데이터를 가져올 수 있다.
						me.set("rfxData.has_no_cd_item", (provider.filterItem({item_cd_crn_typ_ccd: "CDLS"}) != null) ? "Y" : "N");
						me.applyFormula("hasNoCdItem");

						// 1차수인 경우만
						if(me.formula('firstRoundEditable')) {
							var itemLno = 0;
							provider.setItemAtBatch(true, function(index, data) {
								itemLno += 10;
								return {"rfx_lno": itemLno}
							});
						}
					});
				}
			},
			vdGridValidatorFn: function(headerText, dataField, data) {
				var me = this;
				if(dataField === "vd_pic_eml") {
					var vdChrEmail = data[dataField];

					if(UT.isNotEmpty(vdChrEmail)) {
						var regExp = UT.emailRegExp();	//길이 8~20자

						if(!regExp.test(vdChrEmail)) {
							return me.translate("STD.E1017", null, headerText);
						}
					}
					return true;
				}
			},
			// 협력사 추가 버튼 클릭시
			onShowPopupVendor: function() {
				var me = this;

				if(!me.rfxData.oorg_cd) {
					UT.alert("STD.N3400"); //'운영조직을 선택하세요.'
					return false;
				}

				var vdProvider = me.$.vdGridPanel.getDataProvider();
				var singleSelectFlag = (me.rfxData.comp_typ_ccd === "PRICNTR");
				if(singleSelectFlag && vdProvider.getItemSize() > 0) {
					UT.alert("STD.RFX1012");	//"수의계약은 하나의 협력사만 지정이 가능합니다."
					return false;
				}

				var itemProvider = me.$.itemGridPanel.getDataProvider(),
					itemRows     = itemProvider.getItems();
				var itemSGUniqueList = itemRows.reduce(function(a, b) {
					if(!UT.isEmpty(b.sg_cd) && a.indexOf(b.sg_cd) < 0) {
						a.push(b.sg_cd);
					}
					return a;
				}, []);

				//popup defaultParam
				var defaultParam = {
					co_cd: me.codes.param.co_cd,
					oorg_cd: me.rfxData.oorg_cd,
					conn_typ_ccd: "POEO",
					task_typ_ccd: "RX",	 //RFX 담당자 정보 조회
					item_sgs: itemSGUniqueList,
					obd_job_type_code : "RFX_TARGET" // 온보딩 유형
				};

				var vendorPopup = UT.popup('ep-vendor-list', me, "80%", "95%", {
					'selected-items': function(popup, e) {
						var selectedList = e.detail;

						if(singleSelectFlag) {
							var selected = selectedList[0];

							var addRow = {
								vd_cd: selected.vd_cd,
								erp_vd_cd: selected.erp_vd_cd,
								disp_vd_cd: selected.disp_vd_cd,
								vd_nm: selected.disp_vd_nm,
								vd_pic_uuid: selected.chr_id,
								vd_pic_nm: selected.chr_nm,
								vd_chr_mobile: selected.mob,
								vd_pic_eml: selected.eml,
								vd_pic_tel: selected.tel,
								multrnd_subj_xcept_yn: "N"
							};
							if(vdProvider.filterItem({disp_vd_cd: selected.disp_vd_cd}) === null) {
								vdProvider.addItem(addRow);
							} else {
								UT.alert("STD.N1900");	//"중복 데이터가 있습니다."
							}
						} else {
							me.addVdList(selectedList);
						}
					}
				}, {maximizable: true, titleText: "협력사 검색"});
				vendorPopup.show();
				vendorPopup.getWindowContent().load({'singleSelect': singleSelectFlag, 'defaultParam': defaultParam});
			},
			// 협력사 리스트 추가
			addVdList: function(selectedList) {
				var me = this;

				var provider = me.$.vdGridPanel.getDataProvider();

				var dupCnt = 0;
				if(selectedList.length > 0) {
					for(var i = 0; i < selectedList.length; i++) {
						var selected = selectedList[i];

						if(provider.filterItem({disp_vd_cd: selected.disp_vd_cd}) === null) {
							var addRow = {
								vd_cd: selected.vd_cd,
								erp_vd_cd: selected.erp_vd_cd,
								disp_vd_cd: selected.disp_vd_cd,
								vd_nm: selected.disp_vd_nm || selected.vd_nm,
								vd_pic_uuid: selected.chr_id,
								vd_pic_nm: selected.chr_nm,
								vd_chr_mobile: selected.mob,
								vd_pic_eml: selected.eml,
								vd_pic_tel: selected.tel,
								multrnd_subj_xcept_yn: "N",
								auto_rcmd_vd_yn: "N"
							};
							provider.addItem(addRow);
						} else {
							dupCnt++;
						}
					}
					if(dupCnt > 0) {
						UT.alert(me.translate("STD.N2010", null, dupCnt), null, true); // 중복 데이터 {0}건 제외 후 추가하였습니다
					}
				} else {
					UT.alert("STD.N1600"); // 선택된 항목이 없습니다
				}
			},
			// 협력사 자동추천 버튼 클릭시
			onShowPopupRcmdOption: function() {
				var me = this;

				var itemProvider = me.$.itemGridPanel.getDataProvider();
				if(itemProvider.getItemSize() === 0) {
					UT.alert("STD.RFX1088");	// 자동추천을 수행하기 전에 품목을 추가해야 합니다.
					return;
				}

				// 정규 등록품목이 존재하지 않는 경우
				if(itemProvider.filterItem({item_cd_crn_typ_ccd: "ITEM_CD"}) == null) {
					UT.alert("STD.RFX1097");	// 정규 등록된 품목정보가 존재하지 않아 협력사 자동추천이 불가합니다.
					return;
				}

				// 추천 옵션 팝업 호출
				me.showRcmdOptionPopup({}, {"titleText": "추천 옵션 설정"});
			},
			// 추천 옵션 팝업
			showRcmdOptionPopup: function(param, options) {
				var me = this;

				var optionPopup = UT.popup("ep-rfx-vd-rcmd-option", me, 500, 500, {
					'apply': function(popup, e) {	// 팝업에서 "적용" 시
						var targetRcmdCds = e.detail;

						// 추천업체 존재여부
						var provider = me.$.vdGridPanel.getDataProvider();
						var hasRcmdVd = (provider.filterItem({auto_rcmd_vd_yn: "Y"}) != null)

						// 기존 추천업체 존재여부에 따른 confirm message 처리
						var message = "";
						if(hasRcmdVd) {
							message = me.translate("STD.RFX1090") + "<br/>";	// 기존 자동추천된 협력사정보는 초기화됩니다.
						}
						message += me.translate("STD.RFX1091");	// 자동추천 하시겠습니까?

						UT.confirm(message, function() {
							// 기존 추천 업체가 있다면 추천업체 초기화
							if(hasRcmdVd) {
								me.clearRcmdVendor();
							}
							// 추천업체 조회
							me.findRcmdVendor(targetRcmdCds);

							// 팝업 닫기
							popup.close();

						}, null, true);
					}
				}, options);
				optionPopup.show();
				optionPopup.getWindowContent().load(param);
			},
			// 추천업체 초기화
			clearRcmdVendor: function() {
				var me = this;

				// 기존의 추천업체 삭제
				var provider = me.$.vdGridPanel.getDataProvider();
				provider.removeItemAtBatch(true, function(index, data) {
					if(data.auto_rcmd_vd_yn === "Y") {
						return true;
					}
				});
			},
			// 추천업체 조회
			findRcmdVendor: function(targetRcmdCds) {
				var me = this;

				// 파라미터 설정
				var itemCds = [], sgCds = [];
				var itemProvider = me.$.itemGridPanel.getDataProvider(),
					items        = itemProvider.getItems();
				for(var i = 0, len = items.length; i < len; i++) {
					var item   = items[i],
						itemCd = item.item_cd,
						sgCd   = item.sg_cd;

					if(UT.isNotEmpty(itemCd) && itemCds.indexOf(itemCd) === -1) {
						itemCds.push(itemCd);
					}
					if(UT.isNotEmpty(sgCd) && sgCds.indexOf(sgCd) === -1) {
						sgCds.push(sgCd);
					}
				}
				me.$.findListRcmdVd.body = {
					"oorg_cd": me.rfxData.oorg_cd,
					"purc_typ_ccd": me.rfxData.purc_typ_ccd,
					"item_cds": itemCds,
					"sg_cds": sgCds,
					"rcmd_cds": targetRcmdCds
				};

				// 추천업체 조회
				UT.request(me.$.findListRcmdVd, function(e, res) {
					var result = res.response;
					me.addRcmdVendor(result);
				});
			},
			// 추천업체 추가
			addRcmdVendor: function(addVendors) {
				var me = this;

				var provider = me.$.vdGridPanel.getDataProvider();
				var vendors = provider.getItems();

				var dupVdCds = [], addVdCds = [];
				if(addVendors.length > 0) {
					for(var i = 0, len = addVendors.length; i < len; i++) {
						var addVendor = addVendors[i];

						// 기존 추가된 업체와 중복되지 않는 경우에만 추가한다.
						if(provider.filterItem({disp_vd_cd: addVendor.disp_vd_cd}) === null) {
							provider.addItem(addVendor);
							addVdCds.push(addVendor.disp_vd_cd);
						} else {
							dupVdCds.push(addVendor.disp_vd_cd);
						}
					}
					// 중복 존재 시
					if(dupVdCds.length > 0) {
						if(addVdCds.length > 0) {
							// 중복되지 않고 추가된 업체가 하나라도 존재할 경우
							UT.alert(me.translate("STD.RFX1086", null, dupVdCds.toString()), null, true);	// 중복되는 대상을 제외하고 추천 협력사를 추가하였습니다.<br/>중복 협력사 코드: {0}
						} else {
							// 모든 추천업체가 중복되어 추가된 업체가 하나도 없는 경우
							UT.alert(me.translate("STD.RFX1092", null, dupVdCds.toString()), null, true);	// 추천 협력사가 기존에 추가된 협력사와 중복되어 추가된 내역이 없습니다.<br/>중복 협력사 코드: {0}
						}
					}
				} else {
					UT.alert("STD.RFX1087");	// 추천대상이 존재하지 않습니다.
				}
			},
			// 협력사 삭제 버튼 클릭시
			onDeleteRfxVendor: function() {
				var me = this;

				var provider = me.$.vdGridPanel.getDataProvider();
				var checked = provider.selectionCheckedItems();

				if(checked.length === 0) {
					UT.alert("STD.N1600"); // 선택된 항목이 없습니다
				} else {
					var submitQtaVds = [];
					// multi-round 작성중이면 이전 제출업체는 삭제 불가함(협력사 제외로 해야함)
					if(me.formula("isMultiRound")) {
						for(var i = 0; i < checked.length; i++) {
							var vd = checked[i];
							if(UT.isNotEmpty(vd.rfx_bid_uuid)) {
								submitQtaVds.push(vd.disp_vd_cd);
							}
						}
					}
					if(submitQtaVds.length > 0) {
						//이전 차수의 견적 제출업체는 삭제할 수 없습니다.<br/>
						//해당 업체들은 "제외"를 진행하여 대상에서 제외할 수 있습니다.<br/>
						//[협력사 코드 : {0}]
						UT.alert(me.translate("STD.RFX1080", null, submitQtaVds.toString()), null, true);
						return;
					} else {
						UT.confirm("STD.N1300", function() {	// "삭제 하시겠습니까?"
							provider.removeItems(true);	// 그리드에서 체크된 데이터를 지워주고, db에서 삭제해야 할 데이터 목록울 리턴한다.
						});
					}
				}
			},
			// 협력사 제외 버튼 클릭 시 (멀티라운드시 견적 대상제외 가능)
			onExcVendor: function() {
				var me = this;

				var provider = me.$.vdGridPanel.getDataProvider();
				var selectedIndexes = provider.selectionCheckedIndexes();

				if(selectedIndexes.length > 0) {
					me.set("selectedVdItemIndexes", selectedIndexes);
					me.$.dialog_multrnd_xcept_rsn.show();
				} else {
					UT.alert("STD.N1600"); // 선택된 항목이 없습니다
				}
			},
			// 제외 사유 dialog 입력 버튼 클릭시
			onExcCause: function() {
				var me = this;
				var multrnd_xcept_rsn_text = me.$.dialog_multrnd_xcept_rsn_text.value;

				var provider = me.$.vdGridPanel.getDataProvider();
				var selectedIndexes = me.get("selectedVdItemIndexes");

				provider.setItemAtBatch(selectedIndexes, function(index, data) { //index: rowIndex, data: row데이터
					return {
						'multrnd_subj_xcept_yn': 'Y',
						'multrnd_xcept_rsn': multrnd_xcept_rsn_text
					};
				});

				UT.alert("STD.RFX1052");
				me.onDialogClose();
			},
			// dialog 닫기 버튼 클릭 시
			onDialogClose: function() {
				var me = this;

				me.set("selectedVdItemIndexes", []);
				me.$.dialog_multrnd_xcept_rsn_text.value = "";
				me.$.dialog_multrnd_xcept_rsn.close();
			},
			// 제외취소
			onCancelExcVendor: function() {
				var me = this;

				var provider = me.$.vdGridPanel.getDataProvider();
				var selectedIndexes = provider.selectionCheckedIndexes();

				if(selectedIndexes.length === 0) {
					UT.alert("STD.N1600"); // 선택된 항목이 없습니다
				} else {
					provider.setItemAtBatch(selectedIndexes, function(index, data) { //index: rowIndex, data: row데이터
						return {
							'multrnd_subj_xcept_yn': 'N',
							'multrnd_xcept_rsn': null
						};
					});

				}
			},
			// 품목 별 계약 및 발주 이력 조회
			showItemContractHistory: function(itemCd) {
				var me = this;

				/* highchart
				var itemHistoryPopup = UT.popup("ep-item-contract-history", me, "90%", "80%");
				itemHistoryPopup.show();
				itemHistoryPopup.getWindowContent().load(itemCd);
				*/

				/* smart-chart */
				var itemHistoryPopup = UT.popup("ep-item-perform", me, "90%", "80%", null, {titleText : I18N.translate("품목 정보")});
				itemHistoryPopup.show();
				itemHistoryPopup.getWindowContent().load({item_cd: itemCd});
			},
			// 협력사 별 계약 및 발주 이력 조회
			showVendorContractHistory: function(vdCd) {
				var me = this;

				/* highchart
				var vdHistoryPopup = UT.popup("ep-vendor-contract-history", me, "90%", "80%");
				vdHistoryPopup.show();
				vdHistoryPopup.getWindowContent().load(vdCd);
				*/

				/* smart-chart */
				var vdHistoryPopup = UT.popup("ep-vendor-perform", me, "90%", "80%");
				vdHistoryPopup.show();
				vdHistoryPopup.getWindowContent().load({vd_cd: vdCd});
			},
			// 계약 기간 계산
			computeCntrPrdDate: function(items) {
				var me = this;

				var max = function(a, b) {
					if(UT.isDate(a) && UT.isDate(b)) {
						return a.getTime() >= b.getTime() ? a : b;
					} else if(UT.isString(a) && UT.isString(b)) {
						return parseInt(a, 10) >= parseInt(b, 10) ? a : b;
					} else {
						return UT.isString(a) ? a : UT.isString(b) ? b : null;
					}
				}
				var min = function(a, b) {
					if(UT.isDate(a) && UT.isDate(b)) {
						return a.getTime() <= b.getTime() ? a : b;
					} else if(UT.isString(a) && UT.isString(b)) {
						return parseInt(a, 10) <= parseInt(b) ? a : b;
					} else {
						return UT.isString(a) ? a : UT.isString(b) ? b : null;
					}
				}
				var sd = null, ed = null;
				for(var i = 0, len = items.length; i < len; i++) {
					sd = min(sd, items[i].const_st_dt);
					ed = max(ed, items[i].const_exp_dt);
				}
				if(UT.isDate(sd)) {
					me.set("rfxData.cntr_st_dt", UT.formatDate(sd, "yyyyMMdd"));
				} else {
					me.set("rfxData.cntr_st_dt", sd);
				}
				if(UT.isDate(ed)) {
					me.set("rfxData.cntr_exp_dt", UT.formatDate(ed, "yyyyMMdd"));
				} else {
					me.set("rfxData.cntr_exp_dt", ed);
				}
			},
			// 품목 규격 상세 팝업
			showDetailSpec: function(data, provider) {
				var me = this;

				var readonly = !me.formula('noCdItemAddable');
				var popup = UT.popup('ep-item-detail-spec', me, 400, (readonly ? 240 : 260), {
					"clear-dtl-spec": function(popup, e) {
						provider.setItemAt(me.rowIndex, {
							"item_spec_dtl": null
						});
						popup.close();
					},
					"apply-dtl-spec": function(popup, e) {
						var dtlSpec = e.detail.item_spec_dtl;

						provider.setItemAt(me.rowIndex, {
							"item_spec_dtl": dtlSpec
						});
						popup.close();
					}
				});
				popup.show();
				popup.getWindowContent().load(data, readonly);
			},
			// 입찰공고 조회 버튼 클릭시
			onShowPopupSearchBidNotice: function() {
				var me = this;

				if(!me.rfxData.oorg_cd) {
					UT.alert("STD.N3400"); //'운영조직을 선택하세요.'
					return false;
				}

				var vdProvider = me.$.vdGridPanel.getDataProvider();
				var singleSelectFlag = (me.rfxData.comp_typ_ccd === "PRICNTR");
				if(singleSelectFlag && vdProvider.getItemSize() > 0) {
					UT.alert("STD.RFX1012");	//"수의계약은 하나의 협력사만 지정이 가능합니다."
					return false;
				}

				var itemProvider = me.$.itemGridPanel.getDataProvider(),
					itemRows     = itemProvider.getItems();

				//popup defaultParam
				var defaultParam = {
					co_cd: me.codes.param.co_cd,
					oorg_cd: me.rfxData.oorg_cd,
					conn_typ_ccd: "POEO",
					task_typ_ccd: "RX",	 //RFX 담당자 정보 조회
				};

				var vendorPopup = UT.popup('ep-bidnotice-list', me, "70%", "60%", {
					'selected-items': function(popup, e) {
						var selectedList = e.detail;
						var selected = selectedList[0];
						if(singleSelectFlag) {
							var addRow = {
								vd_cd: selected.vd_cd,
								erp_vd_cd: selected.erp_vd_cd,
								disp_vd_cd: selected.disp_vd_cd,
								vd_nm: selected.vd_nm,
								vd_pic_uuid: selected.chr_id,
								vd_pic_nm: selected.chr_nm,
								vd_chr_mobile: selected.chr_mobile_no,
								vd_pic_eml: selected.chr_email,
								vd_pic_tel: selected.chr_phone_no,
								multrnd_subj_xcept_yn: "N"
							};
							if(vdProvider.filterItem({disp_vd_cd: selected.disp_vd_cd}) === null) {
								vdProvider.addItem(addRow);
							} else {
								UT.alert("STD.N1900");	//"중복 데이터가 있습니다."
							}
						} else {
							me.addVdList(selectedList);
						}
						me.set("rfxData.rfx_prentc_no", selected.rfx_prentc_no)
						popup.close();
					}
				}, {maximizable: true, titleText: "공고 조회"});
				vendorPopup.show();
				vendorPopup.getWindowContent().load({'singleSelect': singleSelectFlag, 'defaultParam': defaultParam});
			},
			onImagePlantSelectShowFunction : function(data, item) {
				if(UT.isNotEmpty(data["item_cd_crn_typ_ccd"]) && data["item_cd_crn_typ_ccd"] === 'CDLS'){ // 무품목코드 일 경우만 표기
					return "search";
				}
				return "";
			},
			changeDomOvrsDivCcd: function(data){
				this.applyFormula('isShowDom', 'isShowOvs');
			},
			changeLongTermProd: function(data){
				this.applyFormula('isShowLongTermBtn');
			},
			initCommonCodeSettingForPymtDlvyMeth: function() {
				var me = this;
				var pymtmethAttrCcds = me.get("codes.pymtmethAttrCcds");
				var domPymtmethFilters = pymtmethAttrCcds.filter(function(code){
					return code.cstr_cnd_val !== "OVS"
				});
				var ovsPymtmethFilters = pymtmethAttrCcds.filter(function(code){
					return code.cstr_cnd_val !== "DOM"
				});

				var dlvymethAttrCcds = me.get("codes.dlvymethAttrCcds");
				var domDlvymethCcds = dlvymethAttrCcds.filter(function(code){
					return code.cstr_cnd_val !== "OVS"
				});
				var ovsDlvymethCcds = dlvymethAttrCcds.filter(function(code){
					return code.cstr_cnd_val !== "DOM"
				});

				me.set("codes.domPymtmethCcds", domPymtmethFilters);
				me.set("codes.ovsPymtmethCcds", ovsPymtmethFilters);
				me.set("codes.domDlvymethCcds", domDlvymethCcds);
				me.set("codes.ovsDlvymethCcds", ovsDlvymethCcds);
			},
			onSalesPlan : function() {
				var me = this;
				var provider = me.$.itemGridPanel.getDataProvider();
				var items = provider.getItems();
				var param = new Object();
				param.items = items;
				var salesPopup = UT.popup('ep-sales-plan-list', me, "70%", "60%", {
					'close': function(popup, e) {
						popup.close();
					}
				}, {maximizable: true, titleText: me.translate("생산 판매계획")});
				salesPopup.show();
				salesPopup.getWindowContent().load(param);
			},
			
			onShowPopupQuickRfx: function () {
				var inviteVendorPopup = UT.popup('ep-rfx-invite-vendor-reg', this, 700, 620, {
					'add-vendor': function(popup, e) {
						var selected = e.detail;
						selected['multrnd_subj_xcept_yn'] = "N";
						selected['auto_rcmd_vd_yn'] = "N";
						this.addVdList([selected]);
						popup.close();
					}.bind(this),
					'close': function(popup, e) {
						popup.close();
					},
				},{titleText:'협력사 초청'});
				
				inviteVendorPopup.show();
				inviteVendorPopup.getWindowContent().load(this.get('rfxData.oorg_cd'));
			}
		});
	</script>
</dom-module>